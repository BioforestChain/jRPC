{"version":3,"file":"comlink-test-web.modern.js","sources":["../../../typings/build/esm/helper.js","../../../typings/build/esm/weakref.shim.js","../../../core/build/esm/helper.js","../../../core/build/esm/ExportStore.js","../../../core/build/esm/ImportStore.js","../../../core/build/esm/ComlinkCore.js","../../../protocol/build/esm/const.js","../../../protocol/build/esm/ModelTransfer.js","../../../sync/build/esm/helper.js","../../../sync/build/esm/const.js","../../../sync/build/esm/SyncModelTransfer.js","../../../sync/build/esm/ComlinkSync.js","../../../../node_modules/@bfchain/util-decorator/build/esm/bindThis.js","../../../../node_modules/@bfchain/util-decorator/build/esm/cacheGetter.js","../../../../node_modules/@bfchain/util-decorator/build/esm/PropArrayHelper.js","../../../../node_modules/@bfchain/util-decorator/build/esm/throttleWrap.js","../../../async/build/esm/Holder.js","../../../async/build/esm/helper.js","../../../async/build/esm/ReflectForbidenMethods.js","../../../async/build/esm/HolderReflect.js","../../../async/build/esm/AsyncModelTransfer.js","../../../async/build/esm/ComlinkAsync.js","../../../duplex-core/build/esm/AtomicsNotifyer.js","../../../duplex-core/build/esm/helper.js","../../../duplex-core/build/esm/DataPkg.js","../../../duplex-core/build/esm/u32.js","../../../duplex-core/build/esm/Duplex.js","../../../channel/build/esm/MagicBinaryPort.js","../../../channel/build/esm/MagicBinaryChannel.js","../../../comlink/build/esm/index.js","../../../duplex-browser/build/esm/Endpoint.js","../../../duplex-browser/build/esm/DuplexFactory.js","../../build/esm/envWrapper/TaskLog.js","../../build/esm/envWrapper/webEnv.js","../../build/esm/1-1.web.test.js"],"sourcesContent":["/**\n * 不能使用instanceof，会触发Proxy的getPrototypeOf\n * @param obj\n */\nexport const isObj = (obj) => {\n    const targetType = typeof obj;\n    return (targetType === \"object\" && obj !== null) || targetType === \"function\";\n};\n","import { isObj } from \"./helper\";\nconst checkUnregisterToken = (unregisterToken) => {\n    if (!isObj(unregisterToken)) {\n        throw new TypeError(`unregisterToken ('${unregisterToken}') must be an object`);\n    }\n};\nconst checkTarget = (target) => {\n    if (!isObj(target)) {\n        throw new TypeError(\"target must be an object\");\n    }\n};\nif (typeof WeakRef === \"undefined\") {\n    const wr = new WeakMap();\n    class WeakRef {\n        constructor(target) {\n            checkTarget(target);\n            wr.set(this, target);\n        }\n        deref() {\n            return wr.get(this);\n        }\n    }\n    Object.defineProperty(globalThis, \"WeakRef\", { value: WeakRef });\n    ///\n}\nif (typeof FinalizationRegistry === \"undefined\") {\n    if (typeof FinalizationGroup !== \"undefined\") {\n        class FinalizationRegistry {\n            constructor(cleanupCallback) {\n                this.fg = new FinalizationGroup((heldValueIter) => {\n                    for (const heldValue of heldValueIter) {\n                        cleanupCallback(heldValue);\n                    }\n                });\n            }\n            register(target, heldValue, unregisterToken) {\n                this.fg.register(target, heldValue, unregisterToken);\n            }\n            unregister(unregisterToken) {\n                this.fg.unregister(unregisterToken);\n            }\n        }\n        Object.defineProperty(globalThis, \"FinalizationRegistry\", {\n            value: FinalizationRegistry,\n        });\n    }\n    else {\n        class FinalizationRegistry {\n            constructor(cleanupCallback) { }\n            register(target, heldValue, unregisterToken) {\n                checkTarget(target);\n                if (unregisterToken !== undefined) {\n                    checkUnregisterToken(unregisterToken);\n                }\n            }\n            unregister(unregisterToken) {\n                checkUnregisterToken(unregisterToken);\n            }\n        }\n        Object.defineProperty(globalThis, \"FinalizationRegistry\", {\n            value: FinalizationRegistry,\n        });\n    }\n}\n","import \"@bfchain/comlink-typings\";\nexport const ESM_REFLECT_FUN_MAP = new Map([\n    [\n        0 /* GetPrototypeOf */,\n        _SyncToCallback((target) => Reflect.getPrototypeOf(target)),\n    ],\n    [\n        1 /* SetPrototypeOf */,\n        _SyncToCallback((target, [proto]) => Reflect.setPrototypeOf(target, proto)),\n    ],\n    [\n        2 /* IsExtensible */,\n        _SyncToCallback((target) => Reflect.isExtensible(target)),\n    ],\n    [\n        3 /* PreventExtensions */,\n        _SyncToCallback((target) => Reflect.preventExtensions(target)),\n    ],\n    [\n        4 /* GetOwnPropertyDescriptor */,\n        _SyncToCallback((target, [prop]) => Reflect.getOwnPropertyDescriptor(target, prop)),\n    ],\n    [\n        5 /* Has */,\n        _SyncToCallback((target, [prop]) => Reflect.has(target, prop)),\n    ],\n    [\n        6 /* Get */,\n        _SyncToCallback((target, [prop]) => Reflect.get(target, prop)),\n    ],\n    [\n        7 /* Set */,\n        _SyncToCallback((target, [prop, value]) => Reflect.set(target, prop, value)),\n    ],\n    [\n        8 /* DeleteProperty */,\n        _SyncToCallback((target, [prop]) => Reflect.deleteProperty(target, prop)),\n    ],\n    [\n        9 /* DefineProperty */,\n        _SyncToCallback((target, [prop, attr]) => Reflect.defineProperty(target, prop, attr)),\n    ],\n    [10 /* OwnKeys */, _SyncToCallback((target) => Reflect.ownKeys(target))],\n    [\n        11 /* Apply */,\n        _SyncToCallback((target, [ctx, ...args]) => Reflect.apply(target, ctx, args)),\n    ],\n    [\n        19 /* SyncApply */,\n        {\n            type: \"async\",\n            fun: (target, [ctx, ...args]) => Reflect.apply(target, ctx, args),\n        },\n    ],\n    [\n        20 /* AsyncApply */,\n        {\n            type: \"sync\",\n            fun: (target, [resolve, reject, ctx, ...args]) => queueMicrotask(async () => {\n                try {\n                    const res = await Reflect.apply(target, ctx, args);\n                    resolve(res);\n                }\n                catch (err) {\n                    reject(err);\n                }\n            }),\n        },\n    ],\n    [\n        12 /* Construct */,\n        _SyncToCallback((target, [newTarget, ...args]) => Reflect.construct(target, args, newTarget)),\n    ],\n    /// 运算符\n    [\n        13 /* Asset */,\n        _SyncToCallback((target, [prop]) => target[prop]),\n    ],\n    [14 /* Typeof */, _SyncToCallback((target) => typeof target)],\n    [\n        15 /* Instanceof */,\n        _SyncToCallback((target, [ctor]) => target instanceof ctor),\n    ],\n    [16 /* JsonStringify */, _SyncToCallback((target) => JSON.stringify(target))],\n    [17 /* JsonParse */, _SyncToCallback((target) => JSON.parse(target))],\n]);\nfunction _SyncToCallback(handler) {\n    return {\n        type: \"sync\",\n        fun: handler,\n    };\n}\nexport const SyncForCallback = (cb, handler) => {\n    try {\n        cb({ isError: false, data: handler() });\n    }\n    catch (error) {\n        cb({ isError: true, error });\n    }\n};\nexport function resolveCallback(cb, data) {\n    cb({ isError: false, data });\n}\nexport function rejectCallback(cb, error) {\n    cb({ isError: true, error });\n}\n/**\n * 生成一个回调函数，通过指定的处理函数，最终传输给cb风格的出口\n * @param output\n * @param transformer\n */\nexport const SyncPiperFactory = (output, transformer) => {\n    return (...args) => {\n        try {\n            output({ isError: false, data: transformer(...args) });\n        }\n        catch (error) {\n            output({ isError: true, error });\n        }\n    };\n};\n/**\n * @TODO 移除这些异步helper\n * 生成一个回调函数，通过指定的处理函数，最终传输给cb风格的出口\n * @param output\n * @param transformer\n */\nexport const AsyncPiperFactory = (output, transformer) => {\n    return async (...args) => {\n        try {\n            output({ isError: false, data: await transformer(...args) });\n        }\n        catch (error) {\n            output({ isError: true, error });\n        }\n    };\n};\nexport const OpenArg = (arg) => {\n    if (arg.isError) {\n        throw arg.error;\n    }\n    return arg.data;\n};\n// let _queueMicrotask: typeof queueMicrotask;\n// if (typeof queueMicrotask === \"function\") {\n//   /// globalThis和queueMicrotask是同个版本出现的\n//   _queueMicrotask = queueMicrotask.bind(globalThis);\n// } else {\n//   const p = Promise.resolve();\n//   _queueMicrotask = (cb) => {\n//     p.then(cb as any).catch((err) => setTimeout(() => {}, 0));\n//   };\n// }\n","export class ExportStore {\n    constructor(name) {\n        this.name = name;\n        /**\n         * 提供给远端的 refId|symId\n         * 远端可以使用 locId 来进行访问本地\n         */\n        this.accId = 0;\n        /**我所导出的引用对象与符号 */\n        this.objIdStore = new Map();\n    }\n    getObjById(id) {\n        const cache = this.objIdStore.get(id);\n        if (cache && cache.type === 0 /* Object */) {\n            return cache.obj;\n        }\n    }\n    getSymById(id) {\n        const cache = this.objIdStore.get(id);\n        if (cache && cache.type === 1 /* Symbol */) {\n            return cache.sym;\n        }\n    }\n    getId(obj) {\n        const cache = this.objIdStore.get(obj);\n        return cache === null || cache === void 0 ? void 0 : cache.id;\n    }\n    /**\n     * 保存对象的引用\n     */\n    saveObjId(obj, id = this.accId++) {\n        const cache = { type: 0 /* Object */, obj, id };\n        this.objIdStore.set(id, cache);\n        this.objIdStore.set(obj, cache);\n        return id;\n    }\n    /**\n     * 保存符号\n     */\n    saveSymId(sym, id = this.accId++) {\n        const cache = { type: 1 /* Symbol */, sym, id };\n        this.objIdStore.set(id, cache);\n        this.objIdStore.set(sym, cache);\n        return id;\n    }\n    /**\n     * 释放对象的引用\n     * @param id\n     */\n    releaseById(id) {\n        // console.log(\"release\", this.name, id);\n        const cache = this.objIdStore.get(id);\n        if (cache) {\n            if (cache.type === 0 /* Object */) {\n                this.objIdStore.delete(cache.obj);\n            }\n            else {\n                this.objIdStore.delete(cache.sym);\n            }\n            this.objIdStore.delete(id);\n            return true;\n        }\n        return false;\n    }\n    exportSymbol(source) {\n        var _a;\n        return (_a = this.getId(source)) !== null && _a !== void 0 ? _a : this.saveSymId(source);\n    }\n    exportObject(source) {\n        var _a;\n        return (_a = this.getId(source)) !== null && _a !== void 0 ? _a : this.saveObjId(source);\n    }\n}\n","export class ImportStore {\n    constructor(name) {\n        this.name = name;\n        /**存储协议扩展信息 */\n        this.idExtendsStore = new Map();\n        /**我所导入的引用对象与符号 */\n        this.proxyIdStore = new Map();\n        this.proxyIdWM = new WeakMap();\n        this._fr = new FinalizationRegistry((id) => this.releaseProxyId(id));\n    }\n    /**\n     * 获取代理对象背后真正的引用信息\n     */\n    getProxy(proxy) {\n        let cache;\n        switch (typeof proxy) {\n            case \"number\":\n            case \"symbol\":\n                cache = this.proxyIdStore.get(proxy);\n                break;\n            case \"object\":\n                if (proxy === null) {\n                    return;\n                }\n            case \"function\":\n                const id = this.proxyIdWM.get(proxy);\n                if (id !== undefined) {\n                    cache = this.proxyIdStore.get(id);\n                }\n                break;\n        }\n        return cache;\n    }\n    isProxy(proxy) {\n        switch (typeof proxy) {\n            case \"symbol\":\n                return this.proxyIdStore.has(proxy);\n            case \"object\":\n                if (proxy === null) {\n                    return false;\n                }\n            case \"function\":\n                return this.proxyIdWM.has(proxy);\n        }\n        return false;\n    }\n    getProxyById(id) {\n        const cache = this.proxyIdStore.get(id);\n        let res;\n        if (cache) {\n            if (cache.type === 0 /* Proxy */) {\n                res = cache.pwr.deref();\n            }\n            else {\n                res = cache.sym;\n            }\n        }\n        return res;\n    }\n    /**\n     * 保存导入引用\n     * @param proxy Proxy<object>|remote-symbol-placeholder\n     * @param id refId\n     */\n    saveProxyId(proxy, id) {\n        let cache;\n        if (typeof proxy === \"symbol\") {\n            cache = {\n                id,\n                type: 1 /* Symbol */,\n                sym: proxy,\n            };\n            this.proxyIdStore.set(proxy, cache);\n        }\n        else {\n            cache = {\n                id,\n                type: 0 /* Proxy */,\n                pwr: new WeakRef(proxy),\n            };\n            this._fr.register(proxy, id, cache.pwr);\n            this.proxyIdWM.set(proxy, id);\n        }\n        this.proxyIdStore.set(id, cache);\n    }\n    /**为某一个对象记录 refId */\n    backupProxyId(proxy, id) {\n        this.proxyIdWM.set(proxy, id);\n    }\n    /**\n     * 释放导入的引用\n     * @param id refId\n     */\n    releaseProxyId(id) {\n        // console.log(\"release\", this.name, id);\n        const cache = this.proxyIdStore.get(id);\n        if (cache) {\n            this.proxyIdStore.delete(id);\n            if (cache.type === 1 /* Symbol */) {\n                this.proxyIdStore.delete(cache.sym);\n            }\n            else {\n                //   this.proxyIdWM.delete(cache.)\n                this._fr.unregister(cache.pwr);\n            }\n            // 删除缓存的扩展信息\n            this.idExtendsStore.delete(id);\n            this._onReleaseCallback(id);\n            return true;\n        }\n        return false;\n    }\n    _onReleaseCallback(id) {\n        return;\n    }\n    /**监听一个引用被释放 */\n    onRelease(cb) {\n        this._onReleaseCallback = cb;\n    }\n}\n// export const importStore = new ImportStore();\n","import \"@bfchain/comlink-typings\";\nimport { ESM_REFLECT_FUN_MAP, OpenArg, resolveCallback, SyncPiperFactory } from \"./helper\";\nimport { ExportStore } from \"./ExportStore\";\nimport { ImportStore } from \"./ImportStore\";\nexport class ComlinkCore {\n    constructor(port, name) {\n        this.port = port;\n        this.name = name;\n        this.exportStore = new ExportStore(this.name);\n        this.importStore = new ImportStore(this.name);\n        /**用于存储导出的域 */\n        this._exportModule = { scope: Object.create(null), isExported: false };\n        this._listen();\n    }\n    $destroy() {\n        throw new Error(\"Method not implemented.\");\n    }\n    _getInitedExportScope() {\n        const { _exportModule } = this;\n        if (_exportModule.isExported === false) {\n            _exportModule.isExported = true;\n            this.exportStore.exportObject(_exportModule.scope);\n        }\n        return _exportModule.scope;\n    }\n    export(source, name = \"default\") {\n        Reflect.set(this._getInitedExportScope(), name, source);\n    }\n    $getEsmReflectHanlder(operator) {\n        const handler = ESM_REFLECT_FUN_MAP.get(operator);\n        if (!handler) {\n            throw new SyntaxError(\"no support operator:\" + operator);\n        }\n        return handler;\n    }\n    _listen() {\n        const { exportStore: exportStore, port } = this;\n        port.onMessage(async (cb, bin) => {\n            const out_void = () => resolveCallback(cb, undefined);\n            const linkObj = this.transfer.transferableBinary2LinkObj(bin);\n            if (linkObj.type === 2 /* In */) {\n                const obj = exportStore.getObjById(linkObj.targetId);\n                if (obj === undefined) {\n                    throw new ReferenceError(\"no found\");\n                }\n                /**预备好结果 */\n                const linkOut = {\n                    type: 3 /* Out */,\n                    // resId: linkObj.reqId,\n                    out: [],\n                    isThrow: false,\n                };\n                const out_linkOut = (anyRes) => {\n                    this.transfer.Any2InOutBinary((iobRet) => {\n                        if (iobRet.isError) {\n                            return cb(iobRet);\n                        }\n                        linkOut.out.push(iobRet.data);\n                        resolveCallback(cb, this.transfer.linkObj2TransferableBinary(linkOut));\n                    }, anyRes);\n                };\n                try {\n                    let res;\n                    /**JS语言中，this对象不用传输。\n                     * 但在Comlink协议中，它必须传输：\n                     * 因为我们使用call/apply模拟，所以所有所需的对象都需要传递进来\n                     */\n                    const operator = this.transfer.InOutBinary2Any(linkObj.in[0]);\n                    const paramList = linkObj.in.slice(1).map((iob) => this.transfer.InOutBinary2Any(iob));\n                    if (18 /* Multi */ === operator) {\n                        /// 批量操作\n                        res = obj;\n                        for (let i = 0; i < paramList.length;) {\n                            const len = paramList[i];\n                            const $operator = paramList[i + 1];\n                            const $paramList = paramList.slice(i + 2, i + 1 + len);\n                            const $handler = this.$getEsmReflectHanlder($operator);\n                            res = $handler.fun(res, $paramList);\n                            if ($handler.type === \"async\") {\n                                res = await res;\n                            }\n                            i += len + 1;\n                        }\n                    }\n                    else {\n                        /// 单项操作\n                        const handler = this.$getEsmReflectHanlder(operator);\n                        res = handler.fun(obj, paramList);\n                        if (handler.type === \"async\") {\n                            res = await res;\n                        }\n                    }\n                    /// 如果有返回结果的需要，那么就尝试进行返回\n                    if (linkObj.hasOut) {\n                        return out_linkOut(res);\n                    }\n                    else {\n                        return out_void();\n                    }\n                }\n                catch (err) {\n                    linkOut.isThrow = true;\n                    return out_linkOut(err);\n                }\n            }\n            else if (linkObj.type === 0 /* Import */) {\n                const scope = this._getInitedExportScope();\n                return this.transfer.Any2InOutBinary((scopeRet) => {\n                    if (scopeRet.isError) {\n                        return cb(scopeRet);\n                    }\n                    resolveCallback(cb, this.transfer.linkObj2TransferableBinary({\n                        type: 1 /* Export */,\n                        module: scopeRet.data,\n                    }));\n                }, scope);\n            }\n            else if (linkObj.type === 4 /* Release */) {\n                exportStore.releaseById(linkObj.locId);\n            }\n            out_void();\n        });\n        this.importStore.onRelease((refId) => {\n            // console.log(\"send release\", refId);\n            port.send(this.transfer.linkObj2TransferableBinary({\n                type: 4 /* Release */,\n                locId: refId,\n            }));\n        });\n    }\n    $getImportModule(output) {\n        const { port } = this;\n        /**\n         * 进行协商握手，取得对应的 refId\n         * @TODO 这里将会扩展出各类语言的传输协议\n         */\n        if (this._importModule === undefined) {\n            port.req(SyncPiperFactory(output, (ret) => {\n                const bin = OpenArg(ret);\n                const linkObj = this.transfer.transferableBinary2LinkObj(bin);\n                if (linkObj.type !== 1 /* Export */) {\n                    throw new TypeError();\n                }\n                /// 握手完成，转成代理对象\n                return (this._importModule = this.transfer.InOutBinary2Any(linkObj.module));\n            }), this.transfer.linkObj2TransferableBinary({ type: 0 /* Import */ }));\n            return;\n        }\n        output({\n            isError: false,\n            data: this._importModule,\n        });\n    }\n}\n","export const IOB_EFT_Factory_Map = new Map([\n    [\n        2 /* Sync */,\n        {\n            factory: Function,\n            toString: (refExtends) => `function ${refExtends.name}() { [remote code] }`,\n        },\n    ],\n]);\nfor (const [funType, { factoryCode, toString }] of [\n    [\n        3 /* SyncGenerator */,\n        {\n            factoryCode: \"return function* () {}.constructor\",\n            toString: (refExtends) => `function *${refExtends.name}() { [remote code] }`,\n        },\n    ],\n    [\n        4 /* Async */,\n        {\n            factoryCode: \"return async function () {}.constructor\",\n            toString: (refExtends) => `async function ${refExtends.name}() { [remote code] }`,\n        },\n    ],\n    [\n        5 /* AsyncGenerator */,\n        {\n            factoryCode: \"return async function* () {}.constructor\",\n            toString: (refExtends) => `async function *${refExtends.name}() { [remote code] }`,\n        },\n    ],\n    [\n        8 /* Class */,\n        {\n            factoryCode: \"return ()=>class {}\",\n            toString: (refExtends) => `class ${refExtends.name} { [remote code] }`,\n        },\n    ],\n]) {\n    let factory;\n    try {\n        factory = Function(factoryCode)();\n    }\n    catch {\n        factory = Function;\n    }\n    IOB_EFT_Factory_Map.set(funType, { factory, toString });\n}\nexport function getFunctionType(fun) {\n    const ctor = fun.constructor;\n    if (ctor) {\n        const ctorName = ctor.name;\n        if (ctorName === \"AsyncGeneratorFunction\") {\n            return 5 /* AsyncGenerator */;\n        }\n        if (ctorName === \"AsyncFunction\") {\n            return 4 /* Async */;\n        }\n        if (ctorName === \"GeneratorFunction\") {\n            return 3 /* SyncGenerator */;\n        }\n    }\n    const str = Object.toString.call(fun);\n    if (str.startsWith(\"class\")) {\n        return 8 /* Class */;\n    }\n    return 2 /* Sync */;\n}\n/**导出者 用于描述一个 function 的导出配置 */\nexport const EXPORT_FUN_DESCRIPTOR_SYMBOL = Symbol(\"function.export\");\n/**获取一个对象的描述信息 */\nexport function getFunctionExportDescription(fun) {\n    return (Reflect.get(fun, EXPORT_FUN_DESCRIPTOR_SYMBOL) ||\n        {});\n}\n/**导入者 缓存一个 function 的导入信息 */\nexport const IMPORT_FUN_EXTENDS_SYMBOL = Symbol(\"function.import\");\n/**\n * 用于替代 RefFunction 的 Function.property.toString\n * @param this\n */\nexport function refFunctionStaticToStringFactory() {\n    function toString() {\n        if (this === self) {\n            /**模拟远端获取到的 */\n            return \"function toString() { [remote code] }\";\n        }\n        const refExtends = Reflect.get(this, IMPORT_FUN_EXTENDS_SYMBOL);\n        const { toString } = refExtends;\n        if (toString.mode === 1 /* static */) {\n            return toString.code;\n        }\n        throw new TypeError();\n    }\n    const self = toString;\n    /**对自我进行源码保护 */\n    Object.defineProperty(self, \"toString\", {\n        configurable: false,\n        writable: false,\n        value: self,\n    });\n    return toString;\n}\nexport function getObjectStatus(obj) {\n    if (Object.isFrozen(obj)) {\n        return 0 /* frozen */;\n    }\n    if (Object.isSealed(obj)) {\n        return 2 /* sealed */;\n    }\n    if (Object.isExtensible(obj)) {\n        return 3 /* preventedExtensions */;\n    }\n    return 7 /* freedom */;\n}\n//#endregion\n//#region IOB_Extends::Symbol\nexport const globalSymbolStore = new Map();\n[\n    \"asyncIterator\",\n    \"hasInstance\",\n    \"isConcatSpreadable\",\n    \"iterator\",\n    \"match\",\n    \"matchAll\",\n    \"replace\",\n    \"search\",\n    \"species\",\n    \"split\",\n    \"toPrimitive\",\n    \"toStringTag\",\n    \"unscopables\",\n].forEach((name) => {\n    const sym = Reflect.get(Symbol, name);\n    if (typeof sym === \"symbol\") {\n        const cache = {\n            sym,\n            name,\n        };\n        globalSymbolStore.set(sym, cache);\n        globalSymbolStore.set(name, cache);\n    }\n});\n//#endregion\n","import { helper } from \"@bfchain/comlink-core\";\nimport { globalSymbolStore, IOB_EFT_Factory_Map, getFunctionType, getObjectStatus, getFunctionExportDescription, } from \"./const\";\nexport class ModelTransfer {\n    constructor(core) {\n        this.core = core;\n    }\n    canClone(obj) {\n        switch (typeof obj) {\n            case \"bigint\":\n            case \"boolean\":\n            case \"number\":\n            case \"string\":\n            case \"undefined\":\n                return true;\n            case \"symbol\":\n            // return Symbol.keyFor(obj) !== undefined;\n            case \"function\":\n                return false;\n            case \"object\":\n                return obj === null;\n        }\n        return false;\n    }\n    /**获取符号的扩展信息 */\n    _getRemoteSymbolItemExtends(sym) {\n        var _a, _b;\n        const globalSymInfo = globalSymbolStore.get(sym);\n        if (globalSymInfo) {\n            return {\n                type: 2 /* Symbol */,\n                global: true,\n                description: globalSymInfo.name,\n                unique: false,\n            };\n        }\n        return {\n            type: 2 /* Symbol */,\n            global: false,\n            description: (_b = (_a = Object.getOwnPropertyDescriptor(sym, \"description\")) === null || _a === void 0 ? void 0 : _a.value) !== null && _b !== void 0 ? _b : sym.toString().slice(7, -1),\n            unique: Symbol.keyFor(sym) !== undefined,\n        };\n    }\n    /**获取一个引用对象的扩展信息 */\n    _getRefItemExtends(obj) {\n        if (typeof obj === \"object\") {\n            return {\n                type: 1 /* Object */,\n                status: getObjectStatus(obj),\n            };\n        }\n        if (typeof obj === \"function\") {\n            const exportDescriptor = getFunctionExportDescription(obj);\n            const funType = getFunctionType(obj);\n            /**\n             * @FIXME 这种判断也是有风险的，因为虽然箭头函数等严格模式不允许执行 `fun.caller = 1`，但因为`caller`并不在属性里，而是在原型链上进行约束的，所以可能会使用`Reflect.set(fun,'caller',1)`从而达成混淆的效果\n             */\n            const isStatic = Object.getOwnPropertyDescriptor(obj, \"caller\") === undefined;\n            return {\n                type: 0 /* Function */,\n                funType,\n                name: obj.name,\n                length: obj.length,\n                isStatic,\n                status: getObjectStatus(obj),\n                instanceOfFunction: obj instanceof Function,\n                canConstruct: funType === 8 /* Class */ ||\n                    (funType === 2 /* Sync */ && isStatic === false),\n                toString: obj.toString === Function.prototype.toString\n                    ? {\n                        mode: 1 /* static */,\n                        code: exportDescriptor.showSourceCode\n                            ? obj.toString()\n                            : IOB_EFT_Factory_Map.get(funType).toString(obj),\n                    }\n                    : { mode: 0 /* dynamic */ },\n            };\n        }\n        throw new TypeError();\n    }\n    Any2InOutBinary(cb, obj) {\n        helper.SyncForCallback(cb, () => {\n            const needClone = this.canClone(obj);\n            let item;\n            /// 可直接通过赋值而克隆的对象\n            if (needClone) {\n                item = {\n                    type: 0 /* Clone */,\n                    data: obj,\n                };\n            }\n            else {\n                /// 对象是否是导入进来的\n                const imp = this.core.importStore.getProxy(obj);\n                if (imp) {\n                    item = {\n                        type: 3 /* Locale */,\n                        locId: imp.id,\n                    };\n                }\n                /// 符号对象需要在远端做一个克隆备份\n                else {\n                    switch (typeof obj) {\n                        case \"symbol\":\n                            item = {\n                                type: 1 /* RemoteSymbol */,\n                                refId: this.core.exportStore.exportSymbol(obj),\n                                extends: this._getRemoteSymbolItemExtends(obj),\n                            };\n                            break;\n                        case \"function\":\n                        case \"object\":\n                            if (obj !== null) {\n                                item = {\n                                    type: 2 /* Ref */,\n                                    refId: this.core.exportStore.exportObject(obj),\n                                    extends: this._getRefItemExtends(obj),\n                                };\n                            }\n                    }\n                }\n            }\n            if (!item) {\n                throw new TypeError(\"Cloud not transfer to IOB\");\n            }\n            return item;\n        });\n    }\n    linkObj2TransferableBinary(obj) {\n        return obj;\n    }\n    transferableBinary2LinkObj(bin) {\n        return bin;\n    }\n}\n","import { helper } from \"@bfchain/comlink-core\";\nconst CB_TO_SYNC_ERROR = new SyntaxError(\"could not transfrom to sync function\");\nexport function CallbackToSync(cbCaller, args, ctx) {\n    let ret = {\n        isError: true,\n        error: CB_TO_SYNC_ERROR,\n    };\n    cbCaller.call(ctx, (_ret) => (ret = _ret), ...args);\n    return helper.OpenArg(ret);\n}\n","export const IS_ASYNC_APPLY_FUN_MARKER = Symbol(\"asyncApplyFun\");\nexport const IS_SYNC_APPLY_FUN_MARKER = Symbol(\"syncApplyFun\");\nexport const PROTOCAL_SENDER = Symbol(\"protocalSender\");\n","import { globalSymbolStore, IMPORT_FUN_EXTENDS_SYMBOL, IOB_EFT_Factory_Map, ModelTransfer, refFunctionStaticToStringFactory, } from \"@bfchain/comlink-protocol\";\nimport \"@bfchain/comlink-typings\";\nimport { CallbackToSync } from \"./helper\";\nimport { PROTOCAL_SENDER } from \"./const\";\nconst SENDER_MARKER = Symbol(\"linkInSender\");\nexport class SyncModelTransfer extends ModelTransfer {\n    constructor(core) {\n        super(core);\n        /**\n         * ref fun statis toString\n         */\n        this._rfsts = refFunctionStaticToStringFactory();\n    }\n    _genLinkInSender(port, refId) {\n        const req = (linkIn) => this._reqLinkIn(port, refId, linkIn);\n        const send = (linkIn) => this._sendLinkIn(port, refId, linkIn);\n        return { __marker__: SENDER_MARKER, send, req };\n    }\n    _getDefaultProxyHanlder(sender) {\n        const proxyHandler = {\n            getPrototypeOf: (_target) => sender.req([0 /* GetPrototypeOf */]),\n            setPrototypeOf: (_target, proto) => sender.req([1 /* SetPrototypeOf */, proto]),\n            isExtensible: (target) => sender.req([2 /* IsExtensible */]),\n            preventExtensions: (_target) => sender.req([3 /* PreventExtensions */]),\n            getOwnPropertyDescriptor: (_target, prop) => sender.req([\n                4 /* GetOwnPropertyDescriptor */,\n                prop,\n            ]),\n            has: (_target, prop) => sender.req([5 /* Has */]),\n            /**导入子模块 */\n            get: (_target, prop, _reciver) => \n            // console.log(\"get\", prop),\n            sender.req([6 /* Get */, prop]),\n            /**发送 set 操作 */\n            set: (_target, prop, value, _receiver) => sender.req([7 /* Set */, prop, value]),\n            deleteProperty: (_target, prop) => sender.req([8 /* DeleteProperty */, prop]),\n            defineProperty: (_target, prop, attr) => sender.req([9 /* DefineProperty */, prop, attr]),\n            ownKeys: (_target) => sender.req([10 /* OwnKeys */]),\n            apply: (_target, thisArg, argArray) => sender.req([11 /* Apply */, thisArg, ...argArray]),\n            construct: (_target, argArray, newTarget) => sender.req([12 /* Construct */, newTarget, ...argArray]),\n        };\n        return proxyHandler;\n    }\n    /**打包指令 */\n    _pkgLinkIn(targetId, linkIn, hasOut) {\n        const { transfer } = this.core;\n        return transfer.linkObj2TransferableBinary({\n            type: 2 /* In */,\n            // reqId,\n            targetId,\n            in: linkIn.map((a) => CallbackToSync(transfer.Any2InOutBinary, [a], transfer)),\n            hasOut,\n        });\n    }\n    _reqLinkIn(port, targetId, linkIn) {\n        const { transfer } = this.core;\n        const tb = this._pkgLinkIn(targetId, linkIn, true);\n        /// 执行请求\n        const bin = CallbackToSync(port.req, [tb], port);\n        /// 处理请求\n        const linkObj = transfer.transferableBinary2LinkObj(bin);\n        if (linkObj.type !== 3 /* Out */) {\n            throw new TypeError();\n        }\n        if (linkObj.isThrow) {\n            const err_iob = linkObj.out.slice().pop();\n            const err = err_iob && transfer.InOutBinary2Any(err_iob);\n            throw err;\n        }\n        const res_iob = linkObj.out.slice().pop();\n        const res = res_iob && transfer.InOutBinary2Any(res_iob);\n        return res;\n    }\n    _sendLinkIn(port, targetId, linkIn) {\n        const { transfer } = this.core;\n        const tb = transfer.linkObj2TransferableBinary({\n            type: 2 /* In */,\n            // reqId,\n            targetId,\n            in: linkIn.map((a) => CallbackToSync(transfer.Any2InOutBinary, [a], transfer)),\n            hasOut: false,\n        });\n        port.send(tb);\n    }\n    /**\n     * 主动生成引用代理\n     * @param port\n     * @param refId\n     */\n    _createImportByRefId(port, refId) {\n        const refHook = this._createImportRefHook(port, refId);\n        const source = refHook.getSource();\n        if (refHook.type === \"object\") {\n            const proxyHanlder = refHook.getProxyHanlder();\n            const proxy = new Proxy(source, proxyHanlder);\n            return proxy;\n        }\n        return source;\n    }\n    getLinkInSenderByProxy(obj) {\n        if (obj) {\n            const sender = obj[PROTOCAL_SENDER];\n            if (sender.__marker__ === SENDER_MARKER) {\n                return sender;\n            }\n        }\n    }\n    _createImportRefHook(port, refId) {\n        const refExtends = this.core.importStore.idExtendsStore.get(refId);\n        if (!refExtends) {\n            throw new ReferenceError();\n        }\n        let ref;\n        if (refExtends.type === 0 /* Function */) {\n            const factory = IOB_EFT_Factory_Map.get(refExtends.funType);\n            if (!factory) {\n                throw new TypeError();\n            }\n            const sourceFun = factory.factory();\n            const funRef = {\n                type: \"object\",\n                getSource: () => sourceFun,\n                getProxyHanlder: () => {\n                    const sender = this._genLinkInSender(port, refId);\n                    const defaultProxyHanlder = this._getDefaultProxyHanlder(sender);\n                    const functionProxyHanlder = {\n                        ...defaultProxyHanlder,\n                        get: (target, prop, receiver) => {\n                            if (prop === \"name\") {\n                                return refExtends.name;\n                            }\n                            if (prop === \"length\") {\n                                return refExtends.length;\n                            }\n                            //#region 自定义属性\n                            if (prop === IMPORT_FUN_EXTENDS_SYMBOL) {\n                                return refExtends;\n                            }\n                            if (prop === PROTOCAL_SENDER) {\n                                return sender;\n                            }\n                            //#endregion\n                            //#region 静态的toString模式下的本地模拟\n                            /**\n                             * 本地模拟的toString，constructor和protoype等等属性都没有绑定远程\n                             * 这里纯粹是为了加速，模拟远端的返回，可以不用\n                             * @TODO 配置成可以可选模式\n                             */\n                            if (prop === \"toString\" &&\n                                refExtends.toString.mode === 1 /* static */) {\n                                return this._rfsts;\n                            }\n                            //#endregion\n                            return defaultProxyHanlder.get(target, prop, receiver);\n                        },\n                    };\n                    return functionProxyHanlder;\n                },\n            };\n            ref = funRef;\n        }\n        else if (refExtends.type === 1 /* Object */) {\n            const sourceObj = {};\n            const objRef = {\n                type: \"object\",\n                getSource: () => sourceObj,\n                getProxyHanlder: () => {\n                    const sender = this._genLinkInSender(port, refId);\n                    const defaultProxyHanlder = this._getDefaultProxyHanlder(sender);\n                    /**\n                     * 因为对象一旦被设置状态后，无法回退，所以这里可以直接根据现有的状态来判断对象的可操作性\n                     * @TODO 使用isExtensible isFrozen isSealed来改进\n                     */\n                    const functionProxyHanlder = {\n                        ...defaultProxyHanlder,\n                        get: (target, prop, receiver) => {\n                            //#region 自定义属性\n                            if (prop === PROTOCAL_SENDER) {\n                                return sender;\n                            }\n                            //#endregion\n                            return defaultProxyHanlder.get(target, prop, receiver);\n                        },\n                        set(target, prop, value, receiver) {\n                            /**目前如果要实现判断是insert还是update，就要基于已经知道有多少的属性来推断，这方面还需要考虑 ArrayLike 的优化\n                             * 这一切可能要做成缓存的模式，缓存被禁止的属性\n                             * @TODO 如果是 不能add 当 可以update 的模式，就要收集哪些是不能add的，之后就要直接在本地禁止\n                             */\n                            if ((refExtends.status & 2 /* update */) === 0) {\n                                return false;\n                            }\n                            return defaultProxyHanlder.set(target, prop, value, receiver);\n                        },\n                        deleteProperty(target, prop) {\n                            if ((refExtends.status & 4 /* delete */) !== 0) {\n                                return defaultProxyHanlder.deleteProperty(target, prop);\n                            }\n                            return false;\n                        },\n                    };\n                    return functionProxyHanlder;\n                },\n            };\n            ref = objRef;\n        }\n        else if (refExtends.type === 2 /* Symbol */) {\n            let sourceSym;\n            if (refExtends.global) {\n                const globalSymInfo = globalSymbolStore.get(refExtends.description);\n                if (!globalSymInfo) {\n                    throw new TypeError();\n                }\n                sourceSym = globalSymInfo.sym;\n            }\n            else {\n                sourceSym = refExtends.unique\n                    ? Symbol.for(refExtends.description)\n                    : Symbol(refExtends.description);\n            }\n            const symRef = {\n                type: \"primitive\",\n                getSource: () => sourceSym,\n            };\n            ref = symRef;\n        }\n        if (!ref) {\n            throw new TypeError();\n        }\n        return ref;\n    }\n    InOutBinary2Any(bin) {\n        const { port, importStore, exportStore } = this.core;\n        switch (bin.type) {\n            //   case LinkItemType.Default:\n            //     return defaultCtx;\n            case 3 /* Locale */:\n                const loc = exportStore.getObjById(bin.locId) || exportStore.getSymById(bin.locId);\n                if (!loc) {\n                    throw new ReferenceError();\n                }\n                return loc;\n            case 2 /* Ref */:\n            case 1 /* RemoteSymbol */:\n                /// 读取缓存中的应用对象\n                let cachedProxy = importStore.getProxyById(bin.refId);\n                if (cachedProxy === undefined) {\n                    // 保存引用信息\n                    importStore.idExtendsStore.set(bin.refId, bin.extends);\n                    /// 使用导入功能生成对象\n                    cachedProxy = this._createImportByRefId(port, bin.refId);\n                    /// 缓存对象\n                    importStore.saveProxyId(cachedProxy, bin.refId);\n                }\n                return cachedProxy;\n            case 0 /* Clone */:\n                return bin.data;\n        }\n        throw new TypeError();\n    }\n}\n","import { ComlinkCore } from \"@bfchain/comlink-core\";\nimport { getFunctionExportDescription, IOB_EFT_Factory_Map, getFunctionType, } from \"@bfchain/comlink-protocol\";\nimport \"@bfchain/comlink-typings\";\nimport { CallbackToSync } from \"./helper\";\nimport { IS_ASYNC_APPLY_FUN_MARKER, IS_SYNC_APPLY_FUN_MARKER } from \"./const\";\nimport { SyncModelTransfer } from \"./SyncModelTransfer\";\nexport class ComlinkSync extends ComlinkCore {\n    constructor(port, name) {\n        super(port, name);\n        this.transfer = new SyncModelTransfer(this);\n        this._syncWM = new WeakMap();\n        this._asyncWM = new WeakMap();\n    }\n    // /**\n    //  * ref fun statis toString\n    //  */\n    // private _rfsts = refFunctionStaticToStringFactory();\n    $getEsmReflectHanlder(opeartor) {\n        const hanlder = super.$getEsmReflectHanlder(opeartor);\n        if (opeartor === 11 /* Apply */ || opeartor === 19 /* SyncApply */) {\n            const applyHanlder = (target, args) => {\n                if (target === Function.prototype.toString) {\n                    const ctx = args[0];\n                    const exportDescriptor = getFunctionExportDescription(ctx);\n                    /// 保护源码\n                    if (!exportDescriptor.showSourceCode) {\n                        // console.log(\"get to string from remote\");\n                        return IOB_EFT_Factory_Map.get(getFunctionType(ctx)).toString({ name: ctx.name });\n                    }\n                }\n                return hanlder.fun(target, args);\n            };\n            return { type: hanlder.type, fun: applyHanlder };\n        }\n        return hanlder;\n    }\n    import(key = \"default\") {\n        const importModule = CallbackToSync(this.$getImportModule, [], this);\n        return Reflect.get(importModule, key);\n    }\n    importAsSync(key = \"default\") {\n        return this.asyncToSync(this.import(key));\n    }\n    asyncToSync(fun) {\n        if (typeof fun !== \"function\") {\n            throw new TypeError();\n        }\n        if (Reflect.get(fun, IS_ASYNC_APPLY_FUN_MARKER)) {\n            return fun;\n        }\n        let syncFun = this._syncWM.get(fun);\n        if (!syncFun) {\n            const sender = this.transfer.getLinkInSenderByProxy(fun);\n            if (!sender) {\n                throw new TypeError();\n            }\n            syncFun = new Proxy(fun, {\n                get(_target, prop, r) {\n                    if (prop === IS_ASYNC_APPLY_FUN_MARKER) {\n                        return true;\n                    }\n                    return Reflect.get(fun, prop, r);\n                },\n                apply: (_target, thisArg, argArray) => {\n                    return sender.req([19 /* SyncApply */, thisArg, ...argArray]);\n                },\n            });\n            this.importStore.backupProxyId(syncFun, this.importStore.getProxy(fun).id);\n            this._syncWM.set(fun, syncFun);\n        }\n        return syncFun;\n    }\n    importAsAsync(key = \"default\") {\n        return this.syncToAsync(this.import(key));\n    }\n    syncToAsync(fun) {\n        if (typeof fun !== \"function\") {\n            throw new TypeError();\n        }\n        if (Reflect.get(fun, IS_SYNC_APPLY_FUN_MARKER)) {\n            return fun;\n        }\n        let asyncFun = this._asyncWM.get(fun);\n        if (!asyncFun) {\n            const sender = this.transfer.getLinkInSenderByProxy(fun);\n            if (!sender) {\n                throw new TypeError();\n            }\n            asyncFun = new Proxy(fun, {\n                get(_target, prop, r) {\n                    if (prop === IS_SYNC_APPLY_FUN_MARKER) {\n                        return true;\n                    }\n                    return Reflect.get(fun, prop, r);\n                },\n                apply: (_target, thisArg, argArray) => {\n                    /// 要使用本地的promise对任务进行包裹，不然对方接下来会进入卡死状态。\n                    return new Promise((resolve, reject) => {\n                        /* 无需返回值，所以走 .send ，这个是异步的，不会造成阻塞 */\n                        sender.send([20 /* AsyncApply */, resolve, reject, thisArg, ...argArray]);\n                    });\n                },\n            });\n            this.importStore.backupProxyId(asyncFun, this.importStore.getProxy(fun).id);\n            this._asyncWM.set(fun, asyncFun);\n        }\n        return asyncFun;\n    }\n}\n","export function bindThis(target, propertyKey, descriptor) {\n    if (!descriptor || typeof descriptor.value !== \"function\") {\n        throw new TypeError(`Only methods can be decorated with @bind. <${propertyKey}> is not a method!`);\n    }\n    return {\n        configurable: true,\n        get() {\n            const bound = descriptor.value.bind(this);\n            Object.defineProperty(this, propertyKey, {\n                value: bound,\n                configurable: true,\n                writable: true,\n            });\n            return bound;\n        },\n    };\n}\n","const CACHE_KEYS_SYMBOL = Symbol(\"CACHE_GETTER_KEYS_STORE\");\nfunction getCacheKeys(protoTarget) {\n    let CACHE_KEYS = Reflect.get(protoTarget, CACHE_KEYS_SYMBOL);\n    if (!CACHE_KEYS) {\n        CACHE_KEYS = new Map();\n        Reflect.set(protoTarget, CACHE_KEYS_SYMBOL, CACHE_KEYS);\n    }\n    return CACHE_KEYS;\n}\nfunction keyGenerator(protoTarget, prop) {\n    const CACHE_KEYS = getCacheKeys(protoTarget);\n    let symbol = CACHE_KEYS.get(prop);\n    if (!symbol) {\n        symbol = Symbol(`[${typeof prop}]${String(prop)}`);\n        CACHE_KEYS.set(prop, symbol);\n    }\n    return symbol;\n}\nexport function cacheGetter(propTarget, prop, descriptor) {\n    if (typeof descriptor.get !== \"function\") {\n        throw new TypeError(`property ${String(prop)} must has an getter function.`);\n    }\n    const source_fun = descriptor.get;\n    const CACHE_VALUE_SYMBOL = keyGenerator(propTarget, prop);\n    const getter = function () {\n        if (CACHE_VALUE_SYMBOL in this) {\n            return this[CACHE_VALUE_SYMBOL].value;\n        }\n        else {\n            const value = source_fun.call(this);\n            const cacheValue = {\n                target: this,\n                value,\n                sourceFun: source_fun,\n            };\n            this[CACHE_VALUE_SYMBOL] = cacheValue;\n            if (descriptor.set === undefined) {\n                try {\n                    Object.defineProperty(this, prop, {\n                        value,\n                        writable: false,\n                        configurable: true,\n                        enumerable: descriptor.enumerable,\n                    });\n                }\n                catch (err) {\n                    console.error(err);\n                }\n            }\n            return value;\n        }\n    };\n    Reflect.set(getter, \"source_fun\", source_fun);\n    descriptor.get = getter;\n    return descriptor;\n}\nexport function cleanGetterCache(target, prop) {\n    const CACHE_KEYS = getCacheKeys(target);\n    if (CACHE_KEYS.has(prop) === false) {\n        return true;\n    }\n    const CACHE_VALUE_SYMBOL = CACHE_KEYS.get(prop);\n    return _cleanGetterCache(target, prop, CACHE_VALUE_SYMBOL);\n}\nexport function cleanAllGetterCache(target) {\n    const CACHE_KEYS = getCacheKeys(target);\n    for (const [prop, symbol] of CACHE_KEYS) {\n        _cleanGetterCache(target, prop, symbol);\n    }\n}\nfunction _cleanGetterCache(target, prop, CACHE_VALUE_SYMBOL) {\n    const cacheValue = Reflect.get(target, CACHE_VALUE_SYMBOL);\n    if (cacheValue === undefined) {\n        return true;\n    }\n    if (Reflect.deleteProperty(cacheValue.target, CACHE_VALUE_SYMBOL) === false) {\n        return false;\n    }\n    Reflect.deleteProperty(cacheValue.target, prop);\n    return true;\n}\n","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __metadata = (this && this.__metadata) || function (k, v) {\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\nimport { bindThis } from \"./bindThis\";\nexport class PropArrayHelper {\n    constructor(pid = Math.random()\n        .toString(36)\n        .substr(2)) {\n        this.pid = pid;\n        this.CLASS_PROTO_ARRAYDATA_POOL = new Map();\n        this.PA_ID_KEY = Symbol(`@PAID:${this.pid}`);\n        this.PA_ID_VALUE = 0;\n    }\n    get(target, key) {\n        var res = new Set();\n        const CLASS_PROTO_ARRAYDATA = this.CLASS_PROTO_ARRAYDATA_POOL.get(key);\n        if (CLASS_PROTO_ARRAYDATA) {\n            do {\n                if (target.hasOwnProperty(this.PA_ID_KEY)) {\n                    const arr_data = CLASS_PROTO_ARRAYDATA.get(target[this.PA_ID_KEY]);\n                    if (arr_data) {\n                        for (var item of arr_data) {\n                            res.add(item);\n                        }\n                    }\n                }\n            } while ((target = Object.getPrototypeOf(target)));\n        }\n        return res;\n    }\n    add(target, key, value) {\n        var CLASS_PROTO_ARRAYDATA = this.CLASS_PROTO_ARRAYDATA_POOL.get(key);\n        if (!CLASS_PROTO_ARRAYDATA) {\n            CLASS_PROTO_ARRAYDATA = new Map();\n            this.CLASS_PROTO_ARRAYDATA_POOL.set(key, CLASS_PROTO_ARRAYDATA);\n        }\n        const pa_id = target.hasOwnProperty(this.PA_ID_KEY)\n            ? target[this.PA_ID_KEY]\n            : (target[this.PA_ID_KEY] = Symbol(`@PAID:${this.pid}#${this.PA_ID_VALUE++}`));\n        var arr_data = CLASS_PROTO_ARRAYDATA.get(pa_id);\n        if (!arr_data) {\n            arr_data = [value];\n            CLASS_PROTO_ARRAYDATA.set(pa_id, arr_data);\n        }\n        else {\n            arr_data.push(value);\n        }\n    }\n    remove(target, key, value) {\n        const CLASS_PROTO_ARRAYDATA = this.CLASS_PROTO_ARRAYDATA_POOL.get(key);\n        if (!CLASS_PROTO_ARRAYDATA) {\n            return;\n        }\n        do {\n            if (!target.hasOwnProperty(this.PA_ID_KEY)) {\n                break;\n            }\n            const pa_id = target[this.PA_ID_KEY];\n            var arr_data = CLASS_PROTO_ARRAYDATA.get(pa_id);\n            if (!arr_data) {\n                return;\n            }\n            const index = arr_data.indexOf(value);\n            if (index !== -1) {\n                arr_data.splice(index, 1);\n                return;\n            }\n        } while ((target = Object.getPrototypeOf(target)));\n    }\n}\n__decorate([\n    bindThis,\n    __metadata(\"design:type\", Function),\n    __metadata(\"design:paramtypes\", [Object, Object]),\n    __metadata(\"design:returntype\", void 0)\n], PropArrayHelper.prototype, \"get\", null);\n__decorate([\n    bindThis,\n    __metadata(\"design:type\", Function),\n    __metadata(\"design:paramtypes\", [Object, Object, Object]),\n    __metadata(\"design:returntype\", void 0)\n], PropArrayHelper.prototype, \"add\", null);\n__decorate([\n    bindThis,\n    __metadata(\"design:type\", Function),\n    __metadata(\"design:paramtypes\", [Object, Object, Object]),\n    __metadata(\"design:returntype\", void 0)\n], PropArrayHelper.prototype, \"remove\", null);\n","export var THROTTLE_WRAP_PLOT;\n(function (THROTTLE_WRAP_PLOT) {\n    THROTTLE_WRAP_PLOT[THROTTLE_WRAP_PLOT[\"WAIT_RESULT_RETURN\"] = 0] = \"WAIT_RESULT_RETURN\";\n    THROTTLE_WRAP_PLOT[THROTTLE_WRAP_PLOT[\"NO_WAIT_EXEC_TIME\"] = 1] = \"NO_WAIT_EXEC_TIME\";\n})(THROTTLE_WRAP_PLOT || (THROTTLE_WRAP_PLOT = {}));\nexport function throttleWrap(ms = 1000, plot = THROTTLE_WRAP_PLOT.WAIT_RESULT_RETURN) {\n    return function (target, name, descriptor) {\n        const source_fun = descriptor.value;\n        let run_lock;\n        descriptor.value = async function lock(...args) {\n            if (run_lock) {\n                run_lock = new Promise((resolve, reject) => {\n                    setTimeout(() => {\n                        const res = source_fun.apply(this, args);\n                        if (plot === THROTTLE_WRAP_PLOT.WAIT_RESULT_RETURN) {\n                            res.then(resolve, reject).finally(() => {\n                                run_lock = undefined;\n                            });\n                        }\n                        else if (plot === THROTTLE_WRAP_PLOT.NO_WAIT_EXEC_TIME) {\n                            resolve(res);\n                            run_lock = undefined;\n                        }\n                        else {\n                            throw new SyntaxError(`No support throttleWrap plot:${THROTTLE_WRAP_PLOT.NO_WAIT_EXEC_TIME}`);\n                        }\n                    }, ms);\n                });\n            }\n            return run_lock;\n        };\n        descriptor.value.source_fun = source_fun;\n        return descriptor;\n    };\n}\n","const NO_ALLOW_PROP = new Set([\n    Symbol.toPrimitive,\n    Symbol.toStringTag,\n    Symbol.hasInstance,\n    Symbol.species,\n    /// 不能直接支持Symbol.iterator，只能用Symbol.asyncIterator来替代Symbol.iterator\n    Symbol.iterator,\n    // Symbol.asyncIterator,\n    Symbol.isConcatSpreadable,\n    Symbol.match,\n    Symbol.matchAll,\n    Symbol.replace,\n    Symbol.search,\n    Symbol.split,\n]);\nconst __THEN_DISABLED__ = new WeakSet();\nexport function createHolderProxyHanlder(holderReflect) {\n    const proxyHanlder = {\n        getPrototypeOf: () => {\n            return null;\n        },\n        setPrototypeOf: () => {\n            throw new Error(\"no support AsyncReflect.setPrototypeOf\");\n            // return false;\n        },\n        isExtensible: () => {\n            throw new Error(\"no support AsyncReflect.isExtensible\");\n        },\n        preventExtensions: () => {\n            throw new Error(\"no support AsyncReflect.preventExtensions\");\n        },\n        getOwnPropertyDescriptor: () => {\n            throw new Error(\"no support AsyncReflect.getOwnPropertyDescriptor\");\n        },\n        defineProperty: () => {\n            throw new Error(\"no support AsyncReflect.defineProperty\");\n        },\n        ownKeys: () => {\n            throw new Error(\"no support AsyncReflect.ownKeys\");\n        },\n        has: () => {\n            throw new Error(\"no support AsyncReflect.has\");\n        },\n        /**导入子模块 */\n        get: (_target, prop, r) => {\n            // 禁止支持一些特定的symbol\n            if (NO_ALLOW_PROP.has(prop)) {\n                return;\n            }\n            if (prop === \"then\") {\n                /// 一次性\n                if (__THEN_DISABLED__.delete(holderReflect)) {\n                    return;\n                }\n                return (resolve, reject) => {\n                    holderReflect.toValueSync((ret) => {\n                        if (ret.isError) {\n                            return reject(ret.error);\n                        }\n                        if (isHolder(ret.data)) {\n                            /// 如果是一个远端对象\n                            const thenFun = holderReflect.assetHolder(\"then\");\n                            thenFun.Operator_typeOfHolder().toValueSync((typeNameRet) => {\n                                if (typeNameRet.isError) {\n                                    return reject(typeNameRet.error);\n                                }\n                                if (typeNameRet.data === \"function\") {\n                                    thenFun\n                                        .applyHolder(holderReflect.toHolder(), [resolve, reject])\n                                        .toValueSync(() => {\n                                        // 这个promise没人捕捉，也不需要捕捉\n                                    });\n                                }\n                                else {\n                                    /// 下面的resolve会导致再次触发then，所以这里要一次性进行then禁用\n                                    __THEN_DISABLED__.add(holderReflect);\n                                    resolve(ret.data);\n                                }\n                            });\n                        }\n                        else {\n                            /// 如果是一个本地对象\n                            if (ret.data && typeof ret.data[\"then\"] === \"function\") {\n                                // 这个promise没人捕捉，也不需要捕捉\n                                ret.data.then(resolve, reject);\n                            }\n                            else {\n                                resolve(ret.data);\n                            }\n                        }\n                    });\n                };\n            }\n            /**迭代器的支持 */\n            if (prop === Symbol.asyncIterator) {\n                return async function* () {\n                    if (await holderReflect.has(Symbol.asyncIterator)) {\n                        yield* holderReflect.asyncIterator();\n                    }\n                    else {\n                        yield* holderReflect.iterator();\n                    }\n                };\n            }\n            return holderReflect.assetHolder(prop).toAsyncValue();\n        },\n        /**发送 set 操作 */\n        set: (_target, prop, value, receiver) => {\n            const setHolderReflect = holderReflect.setHolder(prop, value);\n            let res = true;\n            setHolderReflect.toValueSync((ret) => {\n                if (ret.isError === false) {\n                    res = ret.data;\n                }\n            });\n            return res;\n        },\n        deleteProperty: (target, prop) => {\n            const setHolderReflect = holderReflect.deletePropertyHolder(prop);\n            let res = true;\n            setHolderReflect.toValueSync((ret) => {\n                if (ret.isError === false) {\n                    res = ret.data;\n                }\n            });\n            return res;\n        },\n        apply: (_target, thisArg, argArray) => {\n            const applyHolderReflect = holderReflect.applyHolder(thisArg, argArray);\n            applyHolderReflect.toValueSync(() => {\n                ///强行调取触发指令发送\n            });\n            return applyHolderReflect.toAsyncValue();\n        },\n        construct: (_target, argArray, newTarget) => {\n            const constructHolderReflect = holderReflect.constructHolder(argArray, newTarget);\n            constructHolderReflect.toValueSync(() => {\n                ///强行调取触发指令发送\n            });\n            return constructHolderReflect.toAsyncValue();\n        },\n    };\n    return proxyHanlder;\n}\nconst __HOLDER_REFLECT_WM__ = new WeakMap();\nconst __REFLECT_HOLDER_WM__ = new WeakMap();\nexport function getHolder(holderReflect) {\n    let holder = __REFLECT_HOLDER_WM__.get(holderReflect);\n    if (holder === undefined) {\n        holder = new Proxy(Function(`return function ${holderReflect.name}(){}`)(), createHolderProxyHanlder(holderReflect));\n        __HOLDER_REFLECT_WM__.set(holder, holderReflect);\n        __REFLECT_HOLDER_WM__.set(holderReflect, holder);\n    }\n    return holder;\n}\nexport function isHolder(target) {\n    return __HOLDER_REFLECT_WM__.has(target);\n}\nexport function getHolderReflect(target) {\n    return __HOLDER_REFLECT_WM__.get(target);\n}\n","import { helper } from \"@bfchain/comlink-core\";\nexport function CallbackToAsync(cbCaller, args, ctx) {\n    let syncRet;\n    /// 默认是同步模式\n    let syncResolve = (data) => {\n        syncRet = {\n            isError: false,\n            data,\n        };\n    };\n    let syncReject = (error) => {\n        syncRet = {\n            isError: true,\n            error,\n        };\n    };\n    try {\n        /// 执行，并尝试同步\n        cbCaller.call(ctx, (ret) => {\n            if (ret.isError) {\n                syncReject(ret.error);\n            }\n            else {\n                syncResolve(ret.data);\n            }\n        }, ...args);\n    }\n    catch (err) {\n        syncReject(err);\n    }\n    /// 得到及时的响应，直接返回\n    if (syncRet !== undefined) {\n        return helper.OpenArg(syncRet);\n    }\n    /// 没有得到及时的响应，进入异步模式\n    return new Promise((resolve, reject) => {\n        syncResolve = resolve;\n        syncReject = reject;\n    });\n}\n/**\n * ## 强泛型定义的bind实现\n * 这种写法很骚，因为一共定义了两套泛型，一套是由传入的cbCaller提供，一套由返回后，外界的调用者提供\n * 而cbCaller因为被夹在中间，要用于满足外界调用者的类型定义，所以在内部不得不any化\n *\n * ---\n * 但是这种推导也是**有条件的**\n * 举个例子:\n * ```ts\n * cbCaller = <A1>(cb: BFChainComlink.Callback<Result<A1>>, arg1: A1) => void\n * type Result<T> = ...\n * ```\n * 在上面这个例子中,终点在于 `Result<T>`，\n * 在这里 `R = Result<T>`， 同时 `R2 extends R`。\n * 所以当我们要用R2推导出R的时候， T此时就是由外部输入。\n *\n * 此时如果我们是这样定义 `type Result<T extends ...>` 就会可能出现问题。\n * 比如：\n * ```ts\n * cbCaller = <A1 extends keyof T>(cb: BFChainComlink.Callback<Result<T, A1>>, arg1: A1) => void\n * type Result<T, K extends keyof T> = T[K]\n * ```\n * 因为我们把原本有关系的 `Result<T,A1>` 和 `A1`，分解成了`R`与`ARGS`两个没有关系的类型。\n * 也就是说此时`R`与`ARGS`分别独立携带了一份`A1`，而`R`的那份`A1`则是由`R2`继承过去，用于接收外界的输入。\n * 也就会导致，当我们使用`R2`来尝试推理`A1`时，就会与`ARGS`携带进来的`A1`发生冲突。\n * 编译器无法认证到底要使用哪一种。\n */\nexport function CallbackToAsyncBind(cbCaller, ctx) {\n    return (...args) => CallbackToAsync(cbCaller, args, ctx);\n}\nexport function isNil(value) {\n    return value === undefined || value === null;\n}\nexport function isNoNilPrimivite(value) {\n    switch (typeof value) {\n        case \"bigint\":\n        case \"boolean\":\n        case \"number\":\n        case \"string\":\n        case \"symbol\":\n            return true;\n    }\n    return false;\n}\n","export class ReflectForbidenMethods {\n    constructor() {\n        // nullOrUndefine: reflectForbidenFactory('')\n        this.deleteProperty = this._factory_NoObject(\"deleteProperty\");\n        this.defineProperty = this._factory_NoObject(\"defineProperty\");\n        this.ownKeys = this._factory_NoObject(\"ownKeys\");\n        this.has = this._factory_NoObject(\"has\");\n        this.set = this._factory_NoObject(\"set\");\n        this.get = this._factory_NoObject(\"get\");\n        this.getPrototypeOf = this._factory_NoObject(\"getPrototypeOf\");\n        this.isExtensible = this._factory_NoObject(\"isExtensible\");\n        this.preventExtensions = this._factory_NoObject(\"preventExtensions\");\n        this.setPrototypeOf = this._factory_NoObject(\"setPrototypeOf\");\n        this.apply = this._factory(\"apply\", \"[holder ${this.name}] is not a function\");\n        this.construct = this._factory(\"apply\", \"[holder ${this.name}] is not a constructor\");\n        //   nilConvert = this._factory(\n        //     \"deleteProperty\",\n        //     \"Cannot convert ${this.name}(undefined or null) to object\",\n        //   );\n        //   nilSet = this._factory(\n        //     \"defineProperty\",\n        //     \"Cannot set property '${arguments[0]}' of ${this.name}(undefined or null)\",\n        //   );\n        this.nilGet = this._factory(\"defineProperty\", \"Cannot read property '${arguments[0]}' of ${this.name}(undefined or null)\");\n        //   nilIn = this._factory(\n        //     \"has\",\n        //     \"Cannot use 'in' operator to search for '${arguments[0]}' in ${this.name}(undefined or null)\",\n        //   );\n    }\n    _factory(method, errorMessage) {\n        return Function(`return function ${method}Forbiden(){throw new TypeError(\\`${errorMessage}\\`)}`);\n    }\n    _factory_NoObject(method) {\n        return this._factory(method, `Reflect.${method} called on non-object(\\${this.name})`);\n    }\n}\n","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __metadata = (this && this.__metadata) || function (k, v) {\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\nimport { helper } from \"@bfchain/comlink-core\";\nimport { globalSymbolStore, IMPORT_FUN_EXTENDS_SYMBOL, refFunctionStaticToStringFactory, } from \"@bfchain/comlink-protocol\";\nimport { isObj } from \"@bfchain/comlink-typings\";\nimport { bindThis, cacheGetter, cleanAllGetterCache, cleanGetterCache, } from \"@bfchain/util-decorator\";\nimport { getHolder, getHolderReflect, isHolder } from \"./Holder\";\nimport { CallbackToAsync, CallbackToAsyncBind, isNil } from \"./helper\";\nimport { ReflectForbidenMethods } from \"./ReflectForbidenMethods\";\nimport \"./const\";\nlet ID_ACC = 0;\n//#region 一些辅助性函数\nconst reflectForbidenMethods = new ReflectForbidenMethods();\nconst refFunctionStaticToString = refFunctionStaticToStringFactory();\n/**要兼容Primitive值 */\nfunction alwaysTrueCallbackCaller(cb) {\n    return cb({ isError: false, data: true });\n}\nfunction alwaysFalseCallbackCaller(cb) {\n    return cb({ isError: false, data: false });\n}\nfunction alwaysUndefinedCallbackCaller(cb) {\n    return cb({ isError: false, data: undefined });\n}\nfunction end(iobCacher) {\n    throw new TypeError(`unknown iobCacher type: ${iobCacher}`);\n}\n//#endregion\nexport class HolderReflect {\n    constructor(linkSenderArgs, \n    // public linkInSender: <R>(\n    //   linkIn: readonly [EmscriptenReflect, ...unknown[]],\n    //   hasOut?: BFChainComlink.HolderReflect<R> | false,\n    // ) => unknown,\n    core) {\n        this.linkSenderArgs = linkSenderArgs;\n        this.core = core;\n        this.id = ID_ACC++;\n        this.name = `holder_${this.id}`;\n        this.staticMode = true;\n    }\n    toHolder() {\n        return getHolder(this);\n    }\n    //#region Holder特有接口\n    toValueSync(cb) {\n        let iobCacher = this._iobCacher;\n        let needSend = false;\n        if (iobCacher === undefined) {\n            needSend = true;\n            iobCacher = this._iobCacher = {\n                type: 0 /* WAITING */,\n                waitter: [],\n            };\n        }\n        if (iobCacher.type === 0 /* WAITING */) {\n            iobCacher.waitter.push((ret) => {\n                try {\n                    helper.OpenArg(ret);\n                    iobCacher = this._iobCacher;\n                    if (!iobCacher || iobCacher.type === 0 /* WAITING */) {\n                        throw new TypeError();\n                    }\n                    this.toValueSync(cb);\n                }\n                catch (error) {\n                    cb({ isError: true, error });\n                }\n            });\n            if (needSend) {\n                const { linkSenderArgs } = this;\n                if (linkSenderArgs.linkIn.length === 0) {\n                    throw new TypeError();\n                }\n                if (linkSenderArgs.refId === undefined) {\n                    throw new TypeError(\"no refId\");\n                }\n                this.core.transfer.sendLinkIn(linkSenderArgs.port, linkSenderArgs.refId, linkSenderArgs.linkIn, this);\n                // this.linkInSender(this.linkIn as readonly [EmscriptenReflect, ...unknown[]], this);\n            }\n            return;\n            // iobCacher = this._iobCacher;\n        }\n        if (iobCacher.type === 2 /* LOCAL */ ||\n            iobCacher.type === 4 /* REMOTE_SYMBOL */) {\n            cb({ isError: false, data: iobCacher.value });\n            return;\n        }\n        if (iobCacher.type === 3 /* REMOTE_REF */) {\n            cb({ isError: false, data: this.toHolder() });\n            return;\n        }\n        if (iobCacher.type === 1 /* THROW */) {\n            this._getCatchedReflect().toValueSync((ret) => {\n                const error = helper.OpenArg(ret);\n                cb({ isError: true, error: error });\n            });\n            return;\n        }\n        end(iobCacher);\n    }\n    get toValue() {\n        return CallbackToAsyncBind(this.toValueSync, this);\n    }\n    toAsyncValue() {\n        const iobCacher = this._iobCacher;\n        if (iobCacher &&\n            (iobCacher.type === 2 /* LOCAL */ ||\n                iobCacher.type === 4 /* REMOTE_SYMBOL */)) {\n            return iobCacher.value;\n        }\n        return this.toHolder();\n    }\n    _getCatchedReflect() {\n        let { _catchedReflect: _catched } = this;\n        if (!_catched) {\n            const { _iobCacher: iobCacher } = this;\n            if ((iobCacher === null || iobCacher === void 0 ? void 0 : iobCacher.type) !== 1 /* THROW */) {\n                throw new Error(\"no an error\");\n            }\n            _catched = new HolderReflect(this.linkSenderArgs, this.core);\n            _catched.bindIOB(iobCacher.cacher.iob);\n        }\n        return _catched;\n    }\n    // private _isError?\n    bindIOB(iob, isError = false, port = this.core.port) {\n        const { _iobCacher: iobCacher } = this;\n        /// 如果已经存在iobCacher，而且不是waiting的状态，那么重复绑定了。注意不能用`iobCacher?.type`\n        if (iobCacher !== undefined && iobCacher.type !== 0 /* WAITING */) {\n            throw new TypeError(\"already bind iob\");\n        }\n        const { exportStore, importStore } = this.core;\n        let remoteIob;\n        let newIobCacher;\n        /// 解析iob，将之定义成local或者remote两种模式\n        switch (iob.type) {\n            case 3 /* Locale */:\n                const loc = exportStore.getObjById(iob.locId) || exportStore.getSymById(iob.locId);\n                if (!loc) {\n                    throw new ReferenceError();\n                }\n                newIobCacher = {\n                    type: 2 /* LOCAL */,\n                    value: loc,\n                    iob,\n                };\n                break;\n            case 0 /* Clone */:\n                newIobCacher = { type: 2 /* LOCAL */, value: iob.data, iob };\n                break;\n            case 2 /* Ref */:\n                remoteIob = iob;\n                newIobCacher = { type: 3 /* REMOTE_REF */, port, iob };\n                break;\n            case 1 /* RemoteSymbol */:\n                remoteIob = iob;\n                let sourceSym;\n                const refExtends = iob.extends;\n                if (refExtends.global) {\n                    const globalSymInfo = globalSymbolStore.get(refExtends.description);\n                    if (!globalSymInfo) {\n                        throw new TypeError();\n                    }\n                    sourceSym = globalSymInfo.sym;\n                }\n                else {\n                    sourceSym = refExtends.unique\n                        ? Symbol.for(refExtends.description)\n                        : Symbol(refExtends.description);\n                }\n                newIobCacher = {\n                    type: 4 /* REMOTE_SYMBOL */,\n                    port,\n                    value: sourceSym,\n                    iob,\n                };\n                break;\n        }\n        if (isError) {\n            newIobCacher = {\n                type: 1 /* THROW */,\n                cacher: newIobCacher,\n            };\n        }\n        this._iobCacher = newIobCacher;\n        if (remoteIob === undefined) {\n            this.linkSenderArgs = {\n                ...this.linkSenderArgs,\n                refId: undefined,\n            };\n        }\n        else {\n            // 保存引用信息\n            importStore.idExtendsStore.set(remoteIob.refId, remoteIob.extends);\n            /// 缓存对象\n            importStore.saveProxyId((isError ? this._getCatchedReflect().toAsyncValue() : this.toAsyncValue()), remoteIob.refId);\n            /// 它是有指令长度的，那么清空指令；对应的，需要重新生成指令发送器\n            this.linkSenderArgs = {\n                ...this.linkSenderArgs,\n                refId: remoteIob.refId,\n                linkIn: [],\n            };\n        }\n        /// 核心属性变更，清理所有getter缓存\n        cleanAllGetterCache(this);\n        iobCacher === null || iobCacher === void 0 ? void 0 : iobCacher.waitter.forEach((cb) => {\n            // try {\n            cb({ isError: false, data: undefined });\n            // } catch (err) {\n            //   console.error(\"uncatch error\", err);\n            // }\n        });\n    }\n    getIOB() {\n        if (this._iobCacher && this._iobCacher.type !== 0 /* WAITING */) {\n            if (this._iobCacher.type === 1 /* THROW */) {\n                return this._iobCacher.cacher.iob;\n            }\n            return this._iobCacher.iob;\n        }\n    }\n    isBindedIOB() {\n        const { _iobCacher } = this;\n        if (_iobCacher && _iobCacher.type !== 0 /* WAITING */) {\n            return true;\n        }\n        return false;\n    }\n    waitIOB() {\n        throw new Error(\"Method not implemented.\");\n    }\n    createSubHolder(subHolderLinkIn) {\n        const { linkSenderArgs } = this;\n        /// 从空指令变成单指令\n        if (linkSenderArgs.linkIn.length === 0) {\n            return new HolderReflect({\n                ...linkSenderArgs,\n                linkIn: subHolderLinkIn,\n            }, this.core);\n        }\n        /// 单指令变成多指令\n        if (linkSenderArgs.linkIn[0] !== 18 /* Multi */) {\n            return new HolderReflect({\n                ...linkSenderArgs,\n                linkIn: [\n                    18 /* Multi */,\n                    /// 加入原有的单指令\n                    linkSenderArgs.linkIn.length,\n                    ...linkSenderArgs.linkIn,\n                    /// 加入新的单指令\n                    subHolderLinkIn.length,\n                    ...subHolderLinkIn,\n                ],\n            }, this.core);\n        }\n        /// 维持多指令\n        return new HolderReflect({\n            ...linkSenderArgs,\n            linkIn: [\n                ...linkSenderArgs.linkIn,\n                /// 加入新的单指令\n                subHolderLinkIn.length,\n                ...subHolderLinkIn,\n            ],\n        }, this.core);\n    }\n    _getSubHolderPrimitiveSync(linkIn, cb) {\n        this.createSubHolder(linkIn).toValueSync(cb);\n    }\n    //#endregion\n    //#region Reflect 接口\n    //#region throw\n    throw_binded(cb) {\n        const iobCacher = this._iobCacher;\n        if (iobCacher.type === 2 /* LOCAL */ ||\n            iobCacher.type === 4 /* REMOTE_SYMBOL */) {\n            helper.rejectCallback(cb, iobCacher.value);\n            return;\n        }\n        if (iobCacher.type === 3 /* REMOTE_REF */) {\n            helper.rejectCallback(cb, this._getCatchedReflect().toHolder());\n            return;\n        }\n        end(iobCacher);\n    }\n    // async throw() {\n    //   const err = await this.toValue();\n    //   throw err;\n    //   // throw await this.toHolder().toString();\n    //   // throw new Error(\"Method not implemented.\");\n    // }\n    //#endregion\n    //#region Reflect.apply\n    apply_local(cb, thisArgument, argumentsList) {\n        helper.resolveCallback(cb, Reflect.apply(this._iobCacher\n            .value, thisArgument, argumentsList));\n    }\n    applyHolder(thisArgument, argumentsList) {\n        return this.createSubHolder([\n            11 /* Apply */,\n            thisArgument,\n            ...argumentsList,\n        ]);\n    }\n    apply_remote(cb, thisArgument, argumentsList) {\n        this.applyHolder(thisArgument, argumentsList).toValueSync(cb);\n    }\n    get applyCallback() {\n        const { _iobCacher: iobCacher } = this;\n        if (\n        // 未知，未发送\n        !iobCacher ||\n            // 未知，未返回\n            iobCacher.type === 0 /* WAITING */ ||\n            /// 已知，远端是函数\n            (iobCacher.type === 3 /* REMOTE_REF */ &&\n                iobCacher.iob.type === 2 /* Ref */ &&\n                iobCacher.iob.extends.type === 0 /* Function */)) {\n            return this.apply_remote;\n        }\n        /// 已知，本地函数\n        if (iobCacher.type === 2 /* LOCAL */ && typeof iobCacher.value === \"function\") {\n            return this.apply_local;\n        }\n        /// 其它\n        if (iobCacher.type === 3 /* REMOTE_REF */ ||\n            iobCacher.type === 4 /* REMOTE_SYMBOL */ ||\n            iobCacher.type === 2 /* LOCAL */) {\n            return reflectForbidenMethods.apply;\n        }\n        if (iobCacher.type === 1 /* THROW */) {\n            return this.throw_binded;\n        }\n        /// 类型安全的非return结束\n        end(iobCacher);\n    }\n    get apply() {\n        return CallbackToAsyncBind(this.applyCallback, this);\n    }\n    //#endregion\n    //#region Reflect.construct\n    construct_local(cb, argumentsList, newTarget) {\n        helper.resolveCallback(cb, Reflect.construct(this._iobCacher\n            .value, argumentsList, newTarget));\n    }\n    constructHolder(argumentsList, newTarget) {\n        return this.createSubHolder([\n            12 /* Construct */,\n            newTarget,\n            ...argumentsList,\n        ]);\n    }\n    construct_remote(cb, argumentsList, newTarget) {\n        this.constructHolder(argumentsList, newTarget).toValueSync(cb);\n    }\n    get constructCallback() {\n        const { _iobCacher: iobCacher } = this;\n        if (\n        // 未知，未发送\n        !iobCacher ||\n            // 未知，未返回\n            iobCacher.type === 0 /* WAITING */) {\n            return this.construct_remote;\n        }\n        /// 已知，远端是函数\n        if (iobCacher.type === 3 /* REMOTE_REF */ &&\n            iobCacher.iob.type === 2 /* Ref */ &&\n            iobCacher.iob.extends.type === 0 /* Function */) {\n            if (iobCacher.iob.extends.canConstruct) {\n                return this.construct_remote;\n            }\n            return reflectForbidenMethods.construct;\n        }\n        /// 已知，本地是函数\n        if (iobCacher.type === 2 /* LOCAL */ && typeof iobCacher.value === \"function\") {\n            return this.construct_local;\n        }\n        /// 其它\n        if (iobCacher.type === 3 /* REMOTE_REF */ ||\n            iobCacher.type === 4 /* REMOTE_SYMBOL */ ||\n            iobCacher.type === 2 /* LOCAL */) {\n            return reflectForbidenMethods.apply;\n        }\n        if (iobCacher.type === 1 /* THROW */) {\n            return this.throw_binded;\n        }\n        /// 类型安全的非return结束\n        end(iobCacher);\n    }\n    get construct() {\n        return CallbackToAsyncBind(this.constructCallback, this);\n    }\n    //#endregion\n    //#region Reflect.defineProperty\n    defineProperty_local(cb, propertyKey, attributes) {\n        helper.resolveCallback(cb, Reflect.defineProperty(this._iobCacher.value, propertyKey, attributes));\n    }\n    definePropertyHolder(propertyKey, attributes) {\n        return this.createSubHolder([\n            9 /* DefineProperty */,\n            propertyKey,\n            attributes,\n        ]);\n    }\n    defineProperty_remote(cb, propertyKey, attributes) {\n        return this.definePropertyHolder(propertyKey, attributes).toValueSync(cb);\n    }\n    get definePropertyCallback() {\n        const { _iobCacher: iobCacher } = this;\n        if (\n        // 未知，未发送\n        !iobCacher ||\n            // 未知，未返回\n            iobCacher.type === 0 /* WAITING */) {\n            return this.defineProperty_remote;\n        }\n        /// 已知，本地\n        if (iobCacher.type === 2 /* LOCAL */) {\n            return this.defineProperty_local;\n        }\n        /// 已知，远端\n        /// 远端Symbol对象\n        if (iobCacher.type === 4 /* REMOTE_SYMBOL */) {\n            return reflectForbidenMethods.defineProperty;\n        }\n        /// 远端引用对象\n        if (iobCacher.type === 3 /* REMOTE_REF */) {\n            return this.defineProperty_remote;\n        }\n        if (iobCacher.type === 1 /* THROW */) {\n            return this.throw_binded;\n        }\n        /// 类型安全的非return结束\n        end(iobCacher);\n    }\n    get defineProperty() {\n        return CallbackToAsyncBind(this.definePropertyCallback, this);\n    }\n    //#endregion\n    //#region Reflect.deleteProperty\n    deleteProperty_localObject(cb, propertyKey) {\n        helper.resolveCallback(cb, Reflect.deleteProperty(this._iobCacher.value, propertyKey));\n    }\n    deletePropertyHolder(propertyKey) {\n        return this.createSubHolder([8 /* DeleteProperty */, propertyKey]);\n    }\n    deleteProperty_remote(cb, propertyKey) {\n        this.deletePropertyHolder(propertyKey).toValueSync(cb);\n    }\n    get deletePropertyCallback() {\n        const { _iobCacher: iobCacher } = this;\n        if (\n        // 未知，未发送\n        !iobCacher ||\n            // 未知，未返回\n            iobCacher.type === 0 /* WAITING */ ||\n            /// 已知，远端的非Symbol对象\n            iobCacher.type === 3 /* REMOTE_REF */) {\n            return this.deleteProperty_remote;\n        }\n        /// 已知，本地object\n        if (iobCacher.type === 2 /* LOCAL */) {\n            // object\n            if (isObj(iobCacher.value)) {\n                return this.deleteProperty_localObject;\n            }\n            // 本地 空值 原始值,\n            return reflectForbidenMethods.deleteProperty;\n        }\n        /// 已知，远端Symbol,\n        if (iobCacher.type === 4 /* REMOTE_SYMBOL */) {\n            return reflectForbidenMethods.deleteProperty;\n        }\n        if (iobCacher.type === 1 /* THROW */) {\n            return this.throw_binded;\n        }\n        /// 类型安全的非return结束\n        end(iobCacher);\n    }\n    get deleteProperty() {\n        return CallbackToAsyncBind(this.deletePropertyCallback, this);\n    }\n    //#endregion\n    //#region Reflect.get\n    get_remoteFunction(cb, propertyKey) {\n        const iobExtends = this._iobCacher.iob.extends;\n        /// 自定义属性\n        if (propertyKey === IMPORT_FUN_EXTENDS_SYMBOL) {\n            return helper.resolveCallback(cb, iobExtends);\n        }\n        if (propertyKey === \"name\") {\n            return helper.resolveCallback(cb, iobExtends.name);\n        }\n        if (propertyKey === \"length\") {\n            return helper.resolveCallback(cb, iobExtends.length);\n        }\n        if (propertyKey === \"arguments\" || propertyKey === \"callee\" || propertyKey === \"caller\") {\n            if (iobExtends.isStatic) {\n                return helper.rejectCallback(cb, new TypeError(\"'caller', 'callee', and 'arguments' properties may not be accessed on strict mode functions or the arguments objects for calls to them\"));\n            }\n            else {\n                /**\n                 * @TODO 这里的 arguments 和 caller 应该使用标准规范去实现\n                 * 无法用 await 来获取，需要调用者的堆栈信息来判定是否有权得到相关信息，\n                 */\n                return helper.resolveCallback(cb, null);\n            }\n        }\n        /**\n         * 静态的toString模式下的本地模拟\n         * 本地模拟的toString，constructor和protoype等等属性都没有绑定远程\n         * 这里纯粹是为了加速，模拟远端的返回，可以不用\n         * @TODO 配置成可以可选模式\n         */\n        if (propertyKey === \"toString\" &&\n            iobExtends.toString.mode === 1 /* static */) {\n            return helper.resolveCallback(cb, refFunctionStaticToString);\n        }\n        /**\n         * function.prototype 属性不是只读，所以跳过，使用远端获取\n         * @TODO 改进 BFChainComlink.AsyncUtil.Remote 的规则\n         */\n        return this.get_remote(cb, propertyKey);\n    }\n    get_local(cb, propertyKey) {\n        const iobCacher = this._iobCacher;\n        helper.resolveCallback(cb, Reflect.get(iobCacher.value, propertyKey));\n    }\n    getHolder(propertyKey) {\n        return this.createSubHolder([\n            6 /* Get */,\n            propertyKey,\n        ]);\n    }\n    get_remote(cb, propertyKey) {\n        this.getHolder(propertyKey).toValueSync(cb);\n    }\n    get getCallback() {\n        const { _iobCacher: iobCacher } = this;\n        if (\n        // 未知，未发送\n        !iobCacher ||\n            // 未知，未返回\n            iobCacher.type === 0 /* WAITING */) {\n            return this.get_remote;\n        }\n        /// 已知，远端\n        if (iobCacher.type === 3 /* REMOTE_REF */) {\n            // function对象\n            if (iobCacher.iob.type === 2 /* Ref */ &&\n                iobCacher.iob.extends.type === 0 /* Function */) {\n                return this.get_remoteFunction;\n            }\n            // object\n            return this.get_remote;\n        }\n        /// 已知, 远端Symbol、本地\n        if (iobCacher.type === 4 /* REMOTE_SYMBOL */) {\n            return reflectForbidenMethods.get;\n        }\n        if (iobCacher.type === 2 /* LOCAL */) {\n            if (isObj(iobCacher.value)) {\n                return this.get_local;\n            }\n            return reflectForbidenMethods.get;\n        }\n        if (iobCacher.type === 1 /* THROW */) {\n            return this.throw_binded;\n        }\n        /// 类型安全的非return结束\n        end(iobCacher);\n    }\n    get get() {\n        return CallbackToAsyncBind(this.getCallback, this);\n    }\n    //#endregion\n    //#region Reflect.getOwnPropertyDescriptor\n    getOwnPropertyDescriptor_remoteFunction(cb, propertyKey) {\n        const iobExtends = this._iobCacher.iob.extends;\n        if (propertyKey === \"name\") {\n            return helper.resolveCallback(cb, {\n                value: iobExtends.name,\n                writable: false,\n                enumerable: false,\n                /* 远端的函数名，暂时强制不支持改名 */\n                configurable: false,\n            });\n        }\n        if (propertyKey === \"length\") {\n            return helper.resolveCallback(cb, {\n                value: iobExtends.length,\n                writable: false,\n                enumerable: false,\n                /* 远端的函数名，暂时强制不支持length */\n                configurable: false,\n            });\n        }\n        if (propertyKey === \"arguments\" || propertyKey === \"callee\" || propertyKey === \"caller\") {\n            /**\n             * iobExtends.isStatic === any\n             * @TODO 这里的 arguments 和 caller 应该使用标准规范去实现\n             * 无法用 await 来获取，需要调用者的堆栈信息来判定是否有权得到相关信息\n             */\n            return helper.resolveCallback(cb, undefined);\n        }\n        /**\n         * 静态的toString模式下的本地模拟\n         * 本地模拟的toString，constructor和protoype等等属性都没有绑定远程\n         * 这里纯粹是为了加速，模拟远端的返回，可以不用\n         * @TODO 配置成可以可选模式\n         */\n        if (propertyKey === \"toString\" &&\n            iobExtends.toString.mode === 1 /* static */) {\n            return helper.resolveCallback(cb, {\n                value: refFunctionStaticToString,\n                writable: false,\n                enumerable: false,\n                /* 远端的函数名，强制修改了toString的实现 */\n                configurable: false,\n            });\n        }\n        /**\n         * function.prototype 属性不是只读，所以跳过，使用远端获取\n         * @TODO 改进 BFChainComlink.AsyncUtil.Remote 的规则\n         */\n        return this.getOwnPropertyDescriptor_remote(cb, propertyKey);\n    }\n    getOwnPropertyDescriptor_local(cb, propertyKey) {\n        const iobCacher = this._iobCacher;\n        helper.resolveCallback(cb, Reflect.getOwnPropertyDescriptor(iobCacher.value, propertyKey));\n    }\n    getOwnPropertyDescriptorHolder(propertyKey) {\n        return this.createSubHolder([\n            4 /* GetOwnPropertyDescriptor */,\n            propertyKey,\n        ]);\n    }\n    getOwnPropertyDescriptor_remote(cb, propertyKey) {\n        this.getOwnPropertyDescriptorHolder(propertyKey).toValueSync(cb);\n    }\n    get getOwnPropertyDescriptorCallback() {\n        const { _iobCacher: iobCacher } = this;\n        if (\n        // 未知，未发送\n        !iobCacher ||\n            // 未知，未返回\n            iobCacher.type === 0 /* WAITING */) {\n            return this.getOwnPropertyDescriptor_remote;\n        }\n        if (iobCacher.type === 2 /* LOCAL */) {\n            if (isObj(iobCacher.value)) {\n                return this.getOwnPropertyDescriptor_local;\n            }\n            return alwaysUndefinedCallbackCaller;\n        }\n        if (iobCacher.type === 3 /* REMOTE_REF */) {\n            if (iobCacher.iob.extends.type === 0 /* Function */) {\n                return this.getOwnPropertyDescriptor_remoteFunction;\n            }\n            return this.getOwnPropertyDescriptor_remote;\n        }\n        if (iobCacher.type === 4 /* REMOTE_SYMBOL */) {\n            return alwaysUndefinedCallbackCaller;\n        }\n        if (iobCacher.type === 1 /* THROW */) {\n            return this.throw_binded;\n        }\n        /// 类型安全的非return结束\n        end(iobCacher);\n    }\n    getOwnPropertyDescriptor(propertyKey) {\n        return CallbackToAsync(this.getOwnPropertyDescriptorCallback, [propertyKey], this);\n    }\n    //#endregion\n    //#region getPrototypeOf\n    getPrototypeOf_local(cb) {\n        const iobCacher = this._iobCacher;\n        helper.resolveCallback(cb, Reflect.getPrototypeOf(iobCacher.value));\n    }\n    getPrototypeOfHolder() {\n        return this.createSubHolder([0 /* GetPrototypeOf */]);\n    }\n    getPrototypeOf_remote(cb) {\n        this.getPrototypeOfHolder().toValueSync(cb);\n    }\n    get getPrototypeOfCallback() {\n        const { _iobCacher: iobCacher } = this;\n        if (\n        // 未知，未发送\n        !iobCacher ||\n            // 未知，未返回\n            iobCacher.type === 0 /* WAITING */) {\n            return this.getPrototypeOf_remote;\n        }\n        if (iobCacher.type === 2 /* LOCAL */) {\n            if (isObj(iobCacher.value)) {\n                return this.getPrototypeOf_local;\n            }\n            return reflectForbidenMethods.getPrototypeOf;\n        }\n        if (iobCacher.type === 3 /* REMOTE_REF */ ||\n            /**\n             * 对于远端symbol，虽然本地有一个影子值，但还是要走远端获取\n             */\n            iobCacher.type === 4 /* REMOTE_SYMBOL */) {\n            return this.getPrototypeOf_remote;\n        }\n        if (iobCacher.type === 1 /* THROW */) {\n            return this.throw_binded;\n        }\n        /// 类型安全的非return结束\n        end(iobCacher);\n    }\n    get getPrototypeOf() {\n        return CallbackToAsyncBind(this.getPrototypeOfCallback, this);\n    }\n    //#endregion\n    //#region Reflect.has\n    has_remoteFunction(cb, propertyKey) {\n        /**\n         * 只要是函数（不论是否是箭头函数），就必然有这些属性\n         */\n        if (\n        /// T1 自身属性\n        propertyKey === \"name\" ||\n            propertyKey === \"length\") {\n            return helper.resolveCallback(cb, true);\n        }\n        const iobExtends = this._iobCacher.iob.extends;\n        /**\n         * 被优化过的模式\n         * @TODO 可以提供性能模式，来对export的函数统一进行Object.seal操作\n         */\n        if ((iobExtends.status & 2 /* update */ && iobExtends.instanceOfFunction) !== 0) {\n            if (\n            /// T2 自身属性 / 原型链\n            propertyKey === \"arguments\" ||\n                propertyKey === \"callee\" ||\n                propertyKey === \"caller\" ||\n                /// T3 Function.原型链\n                propertyKey === \"toString\" ||\n                propertyKey === \"constructor\" ||\n                propertyKey === \"apply\" ||\n                propertyKey === \"bind\" ||\n                propertyKey === \"call\" ||\n                propertyKey === Symbol.hasInstance ||\n                /// T3 Object.原型链\n                propertyKey === \"toLocaleString\" ||\n                propertyKey === \"valueOf\" ||\n                propertyKey === \"isPrototypeOf\" ||\n                propertyKey === \"propertyIsEnumerable\" ||\n                propertyKey === \"hasOwnProperty\"\n            /// T4 非标准属性，v8引擎特有\n            // __proto__,__defineGetter__,__defineSetter__,__lookupGetter__,__lookupSetter__\n            ) {\n                return true;\n            }\n        }\n        /// T2 自身属性 / 原型链\n        if (propertyKey === \"arguments\" || propertyKey === \"callee\" || propertyKey === \"caller\") {\n            /// 非严格函数，属于旧版函数，必然有这些属性\n            if (iobExtends.isStatic === false) {\n                return helper.resolveCallback(cb, true);\n            }\n            /// 严格函数，可能被修改过原型链，所以也说不定\n        }\n        return this.has_remote(cb, propertyKey);\n    }\n    has_local(cb, propertyKey) {\n        const iobCacher = this._iobCacher;\n        helper.resolveCallback(cb, Reflect.has(iobCacher.value, propertyKey));\n    }\n    hasHolder(propertyKey) {\n        return this.createSubHolder([5 /* Has */, propertyKey]);\n    }\n    has_remote(cb, propertyKey) {\n        return this.hasHolder(propertyKey).toValueSync(cb);\n    }\n    get hasCallback() {\n        const { _iobCacher: iobCacher } = this;\n        if (\n        // 未知，未发送\n        !iobCacher ||\n            // 未知，未返回\n            iobCacher.type === 0 /* WAITING */) {\n            return this.has_remote;\n        }\n        if (iobCacher.type === 2 /* LOCAL */) {\n            if (isObj(iobCacher.value)) {\n                return this.has_local;\n            }\n            return reflectForbidenMethods.has;\n        }\n        if (iobCacher.type === 3 /* REMOTE_REF */) {\n            if (iobCacher.iob.extends.type === 0 /* Function */) {\n                return this.has_remoteFunction;\n            }\n            return this.has_remote;\n        }\n        if (iobCacher.type === 4 /* REMOTE_SYMBOL */) {\n            /// 远端的symbol和本地symbol行为是一样的，所以使用本地\n            return this.has_local;\n        }\n        if (iobCacher.type === 1 /* THROW */) {\n            return this.throw_binded;\n        }\n        /// 类型安全的非return结束\n        end(iobCacher);\n    }\n    get has() {\n        return CallbackToAsyncBind(this.hasCallback, this);\n    }\n    //#endregion\n    //#region Reflect.isExtensible\n    isExtensible_local(cb) {\n        const iobCacher = this._iobCacher;\n        helper.resolveCallback(cb, Reflect.isExtensible(iobCacher.value));\n    }\n    isExtensibleHolder() {\n        return this.createSubHolder([2 /* IsExtensible */]);\n    }\n    isExtensible_remote(cb) {\n        this.isExtensibleHolder().toValueSync(cb);\n    }\n    get isExtensibleCallback() {\n        const { _iobCacher: iobCacher } = this;\n        if (\n        // 未知，未发送\n        !iobCacher ||\n            // 未知，未返回\n            iobCacher.type === 0 /* WAITING */) {\n            return this.isExtensible_remote;\n        }\n        if (iobCacher.type === 2 /* LOCAL */) {\n            if (isObj(iobCacher.value)) {\n                return this.isExtensible_local;\n            }\n            return reflectForbidenMethods.isExtensible;\n        }\n        if (iobCacher.type === 3 /* REMOTE_REF */) {\n            if (iobCacher.iob.extends.status & 3 /* preventedExtensions */) {\n                return alwaysFalseCallbackCaller;\n            }\n            return this.isExtensible_remote;\n        }\n        if (iobCacher.type === 4 /* REMOTE_SYMBOL */) {\n            /// 远端的symbol和本地symbol行为是一样的，所以使用本地\n            return reflectForbidenMethods.isExtensible;\n        }\n        if (iobCacher.type === 1 /* THROW */) {\n            return this.throw_binded;\n        }\n        /// 类型安全的非return结束\n        end(iobCacher);\n    }\n    get isExtensible() {\n        return CallbackToAsyncBind(this.isExtensibleCallback, this);\n    }\n    //#endregion\n    //#region Reflect.ownKeys\n    ownKeys_local(cb) {\n        const iobCacher = this._iobCacher;\n        helper.resolveCallback(cb, Reflect.ownKeys(iobCacher.value));\n    }\n    ownKeysHolder() {\n        return this.createSubHolder([\n            10 /* OwnKeys */,\n        ]);\n    }\n    ownKeys_remote(cb) {\n        this.ownKeysHolder().toValueSync(cb);\n    }\n    get ownKeysCallback() {\n        const { _iobCacher: iobCacher } = this;\n        if (\n        // 未知，未发送\n        !iobCacher ||\n            // 未知，未返回\n            iobCacher.type === 0 /* WAITING */ ||\n            iobCacher.type === 3 /* REMOTE_REF */) {\n            return this.ownKeys_remote;\n        }\n        if (iobCacher.type === 2 /* LOCAL */) {\n            if (isObj(iobCacher.value)) {\n                return this.ownKeys_local;\n            }\n            return reflectForbidenMethods.ownKeys;\n        }\n        if (iobCacher.type === 4 /* REMOTE_SYMBOL */) {\n            /// 远端的symbol和本地symbol行为是一样的，所以使用本地\n            return reflectForbidenMethods.ownKeys;\n        }\n        if (iobCacher.type === 1 /* THROW */) {\n            return this.throw_binded;\n        }\n        /// 类型安全的非return结束\n        end(iobCacher);\n    }\n    get ownKeys() {\n        return CallbackToAsyncBind(this.ownKeysCallback, this);\n    }\n    //#endregion\n    //#region Reflect.preventExtensions\n    preventExtensions_local(cb) {\n        const iobCacher = this._iobCacher;\n        helper.resolveCallback(cb, Reflect.preventExtensions(iobCacher.value));\n    }\n    preventExtensionsHolder() {\n        return this.createSubHolder([3 /* PreventExtensions */]);\n    }\n    preventExtensions_remote(cb) {\n        this.preventExtensionsHolder().toValueSync(cb);\n    }\n    preventExtensions_onceRemote(cb) {\n        const iobCacher = this._iobCacher;\n        iobCacher.iob.extends.status &= 3 /* preventedExtensions */;\n        cleanGetterCache(this, \"preventExtensionsCallback\");\n        cleanGetterCache(this, \"preventExtensions\");\n        return this.preventExtensions_remote(cb);\n    }\n    get preventExtensionsCallback() {\n        const { _iobCacher: iobCacher } = this;\n        if (\n        // 未知，未发送\n        !iobCacher ||\n            // 未知，未返回\n            iobCacher.type === 0 /* WAITING */) {\n            return this.preventExtensions_remote;\n        }\n        if (iobCacher.type === 3 /* REMOTE_REF */) {\n            /// 严格模式能满足遵守规则的代码\n            if (this.staticMode) {\n                if ((iobCacher.iob.extends.status & 3 /* preventedExtensions */) !== 0) {\n                    /// 如果已经是冻结状态，那么直接返回\n                    return alwaysTrueCallbackCaller;\n                }\n                /// 非冻结状态，那么只需要触发一次也就不需要再触发，也是永久返回true\n                return this.preventExtensions_onceRemote;\n            }\n            /**\n             * 非严格模式，要考虑对方可能是Proxy对象，所以不能以当前的属性状态做判定\n             */\n            return this.preventExtensions_remote;\n        }\n        if (iobCacher.type === 2 /* LOCAL */) {\n            if (isObj(iobCacher.value)) {\n                return this.preventExtensions_local;\n            }\n            return reflectForbidenMethods.preventExtensions;\n        }\n        if (iobCacher.type === 4 /* REMOTE_SYMBOL */) {\n            /// 远端的symbol和本地symbol行为是一样的，所以使用本地\n            return reflectForbidenMethods.preventExtensions;\n        }\n        if (iobCacher.type === 1 /* THROW */) {\n            return this.throw_binded;\n        }\n        /// 类型安全的非return结束\n        end(iobCacher);\n    }\n    get preventExtensions() {\n        return CallbackToAsyncBind(this.preventExtensionsCallback, this);\n    }\n    //#endregion\n    //#region Reflect.set\n    set_local(cb, propertyKey, value) {\n        const iobCacher = this._iobCacher;\n        helper.resolveCallback(cb, Reflect.set(iobCacher.value, propertyKey, value));\n    }\n    setHolder(propertyKey, value) {\n        return this.createSubHolder([7 /* Set */, propertyKey, value]);\n    }\n    set_remote(cb, propertyKey, value) {\n        return this.setHolder(propertyKey, value).toValueSync(cb);\n    }\n    get setCallback() {\n        const { _iobCacher: iobCacher } = this;\n        if (\n        // 未知，未发送\n        !iobCacher ||\n            // 未知，未返回\n            iobCacher.type === 0 /* WAITING */) {\n            return this.set_remote;\n        }\n        if (iobCacher.type === 3 /* REMOTE_REF */) {\n            /// 严格模式能满足遵守规则的代码，如果已经是冻结状态，那么直接返回\n            if (this.staticMode &&\n                (iobCacher.iob.extends.status & 2 /* update */) !== 0) {\n                /// 如果已经是冻结状态，那么直接返回\n                return alwaysFalseCallbackCaller;\n            }\n            return this.set_remote;\n        }\n        if (iobCacher.type === 2 /* LOCAL */) {\n            if (isObj(iobCacher.value)) {\n                return this.set_local;\n            }\n            return reflectForbidenMethods.set;\n        }\n        if (iobCacher.type === 4 /* REMOTE_SYMBOL */) {\n            /// 远端的symbol和本地symbol行为是一样的，所以使用本地\n            return reflectForbidenMethods.set;\n        }\n        if (iobCacher.type === 1 /* THROW */) {\n            return this.throw_binded;\n        }\n        /// 类型安全的非return结束\n        end(iobCacher);\n    }\n    get set() {\n        return CallbackToAsyncBind(this.setCallback, this);\n    }\n    //#endregion\n    setPrototypeOf_local(cb, proto) {\n        const iobCacher = this._iobCacher;\n        helper.resolveCallback(cb, Reflect.setPrototypeOf(iobCacher.value, proto));\n    }\n    setPrototypeOfHolder(proto) {\n        return this.createSubHolder([1 /* SetPrototypeOf */, proto]);\n    }\n    setPrototypeOf_remote(cb, proto) {\n        return this.setPrototypeOfHolder(proto).toValueSync(cb);\n    }\n    get setPrototypeOfCallback() {\n        const { _iobCacher: iobCacher } = this;\n        if (\n        // 未知，未发送\n        !iobCacher ||\n            // 未知，未返回\n            iobCacher.type === 0 /* WAITING */) {\n            return this.setPrototypeOf_remote;\n        }\n        if (iobCacher.type === 3 /* REMOTE_REF */) {\n            /// 严格模式能满足遵守规则的代码，如果已经是冻结状态，那么直接返回\n            if (this.staticMode &&\n                (iobCacher.iob.extends.status & 3 /* preventedExtensions */) !== 0) {\n                /// 如果已经是冻结状态，那么直接返回\n                return alwaysFalseCallbackCaller;\n            }\n            return this.setPrototypeOf_remote;\n        }\n        if (iobCacher.type === 2 /* LOCAL */) {\n            if (isObj(iobCacher.value)) {\n                return this.setPrototypeOf_local;\n            }\n            return reflectForbidenMethods.setPrototypeOf;\n        }\n        if (iobCacher.type === 4 /* REMOTE_SYMBOL */) {\n            /// 远端的symbol和本地symbol行为是一样的，所以使用本地\n            return reflectForbidenMethods.setPrototypeOf;\n        }\n        if (iobCacher.type === 1 /* THROW */) {\n            return this.throw_binded;\n        }\n        /// 类型安全的非return结束\n        end(iobCacher);\n    }\n    get setPrototypeOf() {\n        return CallbackToAsyncBind(this.setPrototypeOfCallback, this);\n    }\n    //#endregion\n    //#region Reflect 拓展接口\n    /**\n     * @WARN 不支持 with 操作符与对应的 Symbol.unscopables\n     */\n    asset_value(cb, propertyKey) {\n        const iobCacher = this._iobCacher;\n        helper.resolveCallback(cb, iobCacher.value[propertyKey]);\n    }\n    assetHolder(propertyKey) {\n        return this.createSubHolder([\n            13 /* Asset */,\n            propertyKey,\n        ]);\n    }\n    asset_remote(cb, propertyKey) {\n        this.assetHolder(propertyKey).toValueSync(cb);\n    }\n    get assetCallback() {\n        const { _iobCacher: iobCacher } = this;\n        if (\n        // 未知，未发送\n        !iobCacher ||\n            // 未知，未返回\n            iobCacher.type === 0 /* WAITING */) {\n            return this.asset_remote;\n        }\n        /// 已知，远端\n        if (iobCacher.type === 3 /* REMOTE_REF */) {\n            // function对象\n            if (iobCacher.iob.type === 2 /* Ref */ &&\n                iobCacher.iob.extends.type === 0 /* Function */) {\n                return this.get_remoteFunction;\n            }\n            // object\n            return this.get_remote;\n        }\n        /// 已知, 远端Symbol、本地\n        if (iobCacher.type === 4 /* REMOTE_SYMBOL */) {\n            return this.asset_value;\n        }\n        if (iobCacher.type === 2 /* LOCAL */) {\n            if (isNil(iobCacher.value)) {\n                return reflectForbidenMethods.nilGet;\n            }\n            return this.asset_value;\n        }\n        if (iobCacher.type === 1 /* THROW */) {\n            return this.throw_binded;\n        }\n        /// 类型安全的非return结束\n        end(iobCacher);\n    }\n    /**\n     * 访问表达式，类似Reflect.get，但支持primitive\n     * @param cb\n     * @param propertyKey\n     */\n    get asset() {\n        return CallbackToAsyncBind(this.assetCallback, this);\n    }\n    /**支持自定义的Symbol.toPrimitive以及Symbol.toStringTag，前者优先级更高 */\n    toPrimitive(hint) { }\n    /**instanceof 的操作符，支持自定义的Symbol.hasInstance */\n    Operator_instanceOf(Ctor) { }\n    Operator_instanceOfHolder(Ctor) {\n        return this.createSubHolder([15 /* Instanceof */, Ctor]);\n    }\n    /**typeof 的操作符*/\n    Operator_typeOf() { }\n    Operator_typeOfHolder() {\n        const typeName = typeof this;\n        return this.createSubHolder([14 /* Typeof */]);\n    }\n    /**delete 的操作符，支持primitive*/\n    Operator_delete() { }\n    /**... 的操作符*/\n    Operator_spread() { }\n    /**in 的操作符，支持自定义的Symbol.species*/\n    Operator_in() { }\n    /**\n     * @TIP 如果未来Emscripten支持《自定义运算符》，那么这里就需要扩展出更多的操作符了，因为这些操作都是只支持同步的。\n     */\n    /**支持自定义的Symbol.iterator，本地可用for await来进行迭代 */\n    async *iterator() {\n        const iterable = (await this.assetHolder(Symbol.iterator).apply(this.toAsyncValue(), []));\n        do {\n            const item = await iterable.next();\n            if (await item.done) {\n                break;\n            }\n            yield item.value;\n        } while (true);\n    }\n    /**支持自定义的Symbol.asyncIterator，本地可用for await来进行迭代 */\n    async *asyncIterator() {\n        const iterable = (await this.assetHolder(Symbol.asyncIterator).apply(this.toAsyncValue(), []));\n        do {\n            const item = await iterable.next();\n            if (await item.done) {\n                break;\n            }\n            yield item.value;\n        } while (true);\n    }\n    /**支持自定义的Symbol.isConcatSpreadable */\n    Array_concat() { }\n    /**支持自定义的Symbol.match */\n    String_match() { }\n    /**支持自定义的Symbol.matchAll */\n    String_matchAll() { }\n    /**支持自定义的Symbol.replace */\n    String_replace() { }\n    /**支持自定义的Symbol.search */\n    String_search() { }\n    /**支持自定义的Symbol.split */\n    String_split() { }\n    Object_assign() { }\n    Object_create() { }\n    Object_defineProperties() { }\n    Object_defineProperty() { }\n    Object_entries() { }\n    Object_freeze() { }\n    Object_fromEntries() { }\n    Object_getOwnPropertyDescriptor() { }\n    Object_getOwnPropertyDescriptors() { }\n    Object_getOwnPropertyNames() { }\n    Object_getOwnPropertySymbols() { }\n    Object_getPrototypeOf() { }\n    Object_is() { }\n    Object_isExtensible() { }\n    Object_isFrozen() { }\n    Object_isSealed() { }\n    Object_keys() { }\n    Object_preventExtensions() { }\n    Object_seal() { }\n    Object_setPrototypeOf() { }\n    Object_values() { }\n    JSON_stringify() {\n        return this.createSubHolder([16 /* JsonStringify */]);\n    }\n    JSON_parse() {\n        return this.createSubHolder([17 /* JsonParse */]);\n    }\n}\nHolderReflect.isHolder = isHolder;\nHolderReflect.getHolderReflect = getHolderReflect;\n__decorate([\n    cacheGetter,\n    __metadata(\"design:type\", Object),\n    __metadata(\"design:paramtypes\", [])\n], HolderReflect.prototype, \"toValue\", null);\n__decorate([\n    cacheGetter,\n    __metadata(\"design:type\", Object),\n    __metadata(\"design:paramtypes\", [])\n], HolderReflect.prototype, \"applyCallback\", null);\n__decorate([\n    cacheGetter,\n    __metadata(\"design:type\", Object),\n    __metadata(\"design:paramtypes\", [])\n], HolderReflect.prototype, \"apply\", null);\n__decorate([\n    cacheGetter,\n    __metadata(\"design:type\", Object),\n    __metadata(\"design:paramtypes\", [])\n], HolderReflect.prototype, \"constructCallback\", null);\n__decorate([\n    cacheGetter,\n    __metadata(\"design:type\", Object),\n    __metadata(\"design:paramtypes\", [])\n], HolderReflect.prototype, \"construct\", null);\n__decorate([\n    cacheGetter,\n    __metadata(\"design:type\", Object),\n    __metadata(\"design:paramtypes\", [])\n], HolderReflect.prototype, \"defineProperty\", null);\n__decorate([\n    cacheGetter,\n    __metadata(\"design:type\", Object),\n    __metadata(\"design:paramtypes\", [])\n], HolderReflect.prototype, \"deleteProperty\", null);\n__decorate([\n    cacheGetter,\n    __metadata(\"design:type\", Object),\n    __metadata(\"design:paramtypes\", [])\n], HolderReflect.prototype, \"get\", null);\n__decorate([\n    cacheGetter,\n    __metadata(\"design:type\", Object),\n    __metadata(\"design:paramtypes\", [])\n], HolderReflect.prototype, \"getPrototypeOf\", null);\n__decorate([\n    cacheGetter,\n    __metadata(\"design:type\", Object),\n    __metadata(\"design:paramtypes\", [])\n], HolderReflect.prototype, \"has\", null);\n__decorate([\n    cacheGetter,\n    __metadata(\"design:type\", Object),\n    __metadata(\"design:paramtypes\", [])\n], HolderReflect.prototype, \"isExtensible\", null);\n__decorate([\n    cacheGetter,\n    __metadata(\"design:type\", Object),\n    __metadata(\"design:paramtypes\", [])\n], HolderReflect.prototype, \"ownKeys\", null);\n__decorate([\n    cacheGetter,\n    __metadata(\"design:type\", Object),\n    __metadata(\"design:paramtypes\", [])\n], HolderReflect.prototype, \"preventExtensionsCallback\", null);\n__decorate([\n    cacheGetter,\n    __metadata(\"design:type\", Object),\n    __metadata(\"design:paramtypes\", [])\n], HolderReflect.prototype, \"preventExtensions\", null);\n__decorate([\n    cacheGetter,\n    __metadata(\"design:type\", Object),\n    __metadata(\"design:paramtypes\", [])\n], HolderReflect.prototype, \"set\", null);\n__decorate([\n    cacheGetter,\n    __metadata(\"design:type\", Object),\n    __metadata(\"design:paramtypes\", [])\n], HolderReflect.prototype, \"setPrototypeOf\", null);\n__decorate([\n    cacheGetter,\n    __metadata(\"design:type\", Object),\n    __metadata(\"design:paramtypes\", [])\n], HolderReflect.prototype, \"asset\", null);\n__decorate([\n    bindThis,\n    __metadata(\"design:type\", Function),\n    __metadata(\"design:paramtypes\", []),\n    __metadata(\"design:returntype\", void 0)\n], HolderReflect.prototype, \"iterator\", null);\n__decorate([\n    bindThis,\n    __metadata(\"design:type\", Function),\n    __metadata(\"design:paramtypes\", []),\n    __metadata(\"design:returntype\", void 0)\n], HolderReflect.prototype, \"asyncIterator\", null);\n","import { ModelTransfer, refFunctionStaticToStringFactory, } from \"@bfchain/comlink-protocol\";\nimport \"@bfchain/comlink-typings\";\nimport { helper } from \"@bfchain/comlink-core\";\nimport { HolderReflect } from \"./HolderReflect\";\nimport { getHolderReflect } from \"./Holder\";\nimport \"./const\";\nexport class AsyncModelTransfer extends ModelTransfer {\n    constructor(core) {\n        super(core);\n        /**\n         * ref fun statis toString\n         */\n        this._rfsts = refFunctionStaticToStringFactory();\n    }\n    /**这里保持使用cb风格，可以确保更好的性能\n     * @TODO 内部的函数也应该尽可能使用cb风格来实现\n     */\n    sendLinkIn(port, targetId, linkIn, hasOut) {\n        const { transfer } = this.core;\n        const doReq = (linkInIob) => {\n            port.req(async (ret) => {\n                const bin = helper.OpenArg(ret);\n                const linkObj = transfer.transferableBinary2LinkObj(bin);\n                if (linkObj.type !== 3 /* Out */) {\n                    throw new TypeError();\n                }\n                if (linkObj.isThrow) {\n                    const err_iob = linkObj.out.slice().pop();\n                    if (!err_iob) {\n                        throw new TypeError();\n                    }\n                    if (hasOut) {\n                        hasOut.bindIOB(err_iob, true);\n                    }\n                    else {\n                        /// 远端传来的异常，本地却没有可以捕捉的对象，协议不对称！\n                        throw err_iob;\n                    }\n                }\n                else if (hasOut) {\n                    const res_iob = linkObj.out.slice().pop();\n                    if (!res_iob) {\n                        throw new TypeError();\n                    }\n                    hasOut.bindIOB(res_iob);\n                }\n            }, transfer.linkObj2TransferableBinary({\n                type: 2 /* In */,\n                // reqId,\n                targetId,\n                in: linkInIob,\n                hasOut: hasOut !== undefined,\n            }));\n        };\n        /// 无参数需要解析，那么直接发送指令\n        if (linkIn.length === 0) {\n            doReq(linkIn);\n        }\n        else {\n            /**结果列表 */\n            const linkInIOB = [];\n            /**结果列表的实际长度 */\n            let linkInIOBLength = 0;\n            /**是否已经完成中断 */\n            let isRejected = false;\n            /// 解析所有的参数\n            for (let index = 0; index < linkIn.length; index++) {\n                const item = linkIn[index];\n                transfer.Any2InOutBinary((ret) => {\n                    if (isRejected) {\n                        return;\n                    }\n                    if (ret.isError) {\n                        isRejected = true;\n                        if (hasOut) {\n                            hasOut.bindIOB({\n                                type: 0 /* Clone */,\n                                data: ret.error,\n                            }, true);\n                        }\n                        else {\n                            throw ret.error;\n                            // console.error(\"uncatch error:\", ret.error);\n                        }\n                        return;\n                    }\n                    /// 保存解析结果\n                    linkInIOB[index] = ret.data;\n                    linkInIOBLength += 1;\n                    /// 完成所有任务，执行指令发送\n                    if (linkInIOBLength === linkIn.length) {\n                        doReq(linkInIOB);\n                    }\n                }, item);\n            }\n        }\n    }\n    /**\n     * 主动生成引用代理\n     * @param port\n     * @param refId\n     */\n    _createHolderByRefId(port, refId, iob) {\n        const holder = this._getHolder(port, refId, iob);\n        return holder.toAsyncValue();\n    }\n    _getHolder(port, refId, iob) {\n        const holder = new HolderReflect({\n            port,\n            refId,\n            linkIn: [],\n        }, this.core);\n        holder.bindIOB(iob);\n        return holder;\n    }\n    // linkInSenderFactory(port: ComlinkProtocol.BinaryPort, refId: number) {\n    //   return <R>(\n    //     linkIn: readonly [EmscriptenReflect, ...unknown[]],\n    //     hasOut?: BFChainComlink.HolderReflect<R> | false,\n    //   ) => this.sendLinkIn(port, refId, linkIn, hasOut);\n    // }\n    Any2InOutBinary(cb, obj) {\n        const reflectHolder = getHolderReflect(obj);\n        if (reflectHolder !== undefined) {\n            const iob = reflectHolder.getIOB();\n            if (!iob) {\n                /// 还没有绑定，那么就等待其绑定完成\n                return reflectHolder.toValueSync((valRet) => {\n                    if (valRet.isError) {\n                        return cb(valRet);\n                    }\n                    this.Any2InOutBinary(cb, obj);\n                });\n                // throw new TypeError(`reflectHolder ${reflectHolder.name} no bind iob`);\n            }\n            if (iob.type === 0 /* Clone */) {\n                obj = iob.data;\n            }\n        }\n        return super.Any2InOutBinary(cb, obj);\n    }\n    InOutBinary2Any(bin) {\n        const { port, importStore, exportStore } = this.core;\n        switch (bin.type) {\n            //   case LinkItemType.Default:\n            //     return defaultCtx;\n            case 3 /* Locale */:\n                const loc = exportStore.getObjById(bin.locId) || exportStore.getSymById(bin.locId);\n                if (!loc) {\n                    throw new ReferenceError();\n                }\n                return loc;\n            case 2 /* Ref */:\n            case 1 /* RemoteSymbol */:\n                /// 读取缓存中的应用对象\n                let cachedHolder = importStore.getProxyById(bin.refId);\n                if (cachedHolder === undefined) {\n                    /// 使用导入功能生成对象\n                    cachedHolder = this._createHolderByRefId(port, bin.refId, bin);\n                }\n                return cachedHolder;\n            case 0 /* Clone */:\n                return bin.data;\n        }\n        throw new TypeError();\n    }\n}\n","import { ComlinkCore } from \"@bfchain/comlink-core\";\nimport \"@bfchain/comlink-typings\";\nimport \"./HolderReflect\";\nimport { CallbackToAsync } from \"./helper\";\nimport { IOB_EFT_Factory_Map, getFunctionType, getFunctionExportDescription, } from \"@bfchain/comlink-protocol\";\nimport { AsyncModelTransfer } from \"./AsyncModelTransfer\";\nexport class ComlinkAsync extends ComlinkCore {\n    constructor(port, name) {\n        super(port, name);\n        this.transfer = new AsyncModelTransfer(this);\n    }\n    wrap(val) {\n        throw new Error(\"Method not implemented.\");\n    }\n    // readonly holderStore = new HolderStore(this.name);\n    $getEsmReflectHanlder(opeartor) {\n        const hanlder = super.$getEsmReflectHanlder(opeartor);\n        if (opeartor === 11 /* Apply */ || opeartor === 19 /* SyncApply */) {\n            const applyHanlder = (target, args) => {\n                if (target === Function.prototype.toString) {\n                    const ctx = args[0];\n                    const exportDescriptor = getFunctionExportDescription(ctx);\n                    /// 保护源码\n                    if (!exportDescriptor.showSourceCode) {\n                        // console.log(\"get to string from remote\");\n                        return IOB_EFT_Factory_Map.get(getFunctionType(ctx)).toString({ name: ctx.name });\n                    }\n                }\n                return hanlder.fun(target, args);\n            };\n            return { type: hanlder.type, fun: applyHanlder };\n        }\n        return hanlder;\n    }\n    async import(key = \"default\") {\n        const importModule = await CallbackToAsync(this.$getImportModule, [], this);\n        return Reflect.get(importModule, key);\n    }\n}\n","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __metadata = (this && this.__metadata) || function (k, v) {\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\nimport { cacheGetter, cleanGetterCache } from \"@bfchain/util-decorator\";\nimport \"./const\";\nexport class AtomicsNotifyer {\n    constructor(_port) {\n        this._port = _port;\n        this._icbs = new Map();\n        this._remoteMode = 3 /* UNKNOWN */;\n        this._port.onMessage((data) => {\n            if (data instanceof Array) {\n                for (const index of data) {\n                    const cbs = this._icbs.get(index);\n                    if (cbs !== undefined) {\n                        this._icbs.delete(index);\n                        for (const cb of cbs) {\n                            cb();\n                        }\n                    }\n                }\n            }\n        });\n    }\n    waitAsync(si32, index, value) {\n        return new Promise((resolve) => {\n            this.waitCallback(si32, index, value, resolve);\n        });\n    }\n    waitCallback(si32, index, value, cb) {\n        if (Atomics.load(si32, index) !== value) {\n            return cb();\n        }\n        let cbs = this._icbs.get(index);\n        if (cbs === undefined) {\n            cbs = [cb];\n            this._icbs.set(index, cbs);\n        }\n        else {\n            cbs.push(cb);\n        }\n    }\n    set remoteMode(mode) {\n        if (this._remoteMode !== mode) {\n            this._remoteMode = mode;\n            cleanGetterCache(this, \"notify\");\n        }\n    }\n    get remoteMode() {\n        return this._remoteMode;\n    }\n    get notify() {\n        if (this._remoteMode === 2 /* ASYNC */) {\n            return this._notify_async;\n        }\n        if (this._remoteMode === 1 /* SYNC */) {\n            return this._notify_sync;\n        }\n        return this._notify_unknow;\n    }\n    _notify_unknow(si32, indexs) {\n        this._notify_async(si32, indexs);\n        this._notify_sync(si32, indexs);\n    }\n    _notify_async(si32, indexs) {\n        this._port.postMessage(indexs);\n    }\n    _notify_sync(si32, indexs) {\n        for (const index of indexs) {\n            Atomics.notify(si32, index);\n        }\n    }\n}\n__decorate([\n    cacheGetter,\n    __metadata(\"design:type\", Object),\n    __metadata(\"design:paramtypes\", [])\n], AtomicsNotifyer.prototype, \"notify\", null);\n","export function u8Concat(ABC, u8s) {\n    let totalLen = 0;\n    for (const u8 of u8s) {\n        totalLen += u8.length;\n    }\n    const u8a = new Uint8Array(new ABC(totalLen));\n    let offsetLen = 0;\n    for (const u8 of u8s) {\n        u8a.set(u8, offsetLen);\n        offsetLen += u8.length;\n    }\n    return u8a;\n}\n","export class DataPkg {\n    constructor(name, sab) {\n        this.name = name;\n        this.sab = sab;\n        this.si32 = new Int32Array(this.sab);\n        this.su8 = new Uint8Array(this.sab);\n        this.su16 = new Uint16Array(this.sab);\n    }\n}\n","class U32Reader {\n    constructor() {\n        this._u32 = new Uint32Array(1);\n        this._u8 = new Uint8Array(this._u32.buffer);\n    }\n    setByU8(u8) {\n        this._u8.set(u8);\n        return this;\n    }\n    getU32() {\n        return this._u32[0];\n    }\n}\nexport const u32 = new U32Reader();\n","import \"./const\";\n// import { serialize, deserialize } from \"v8\";\nconst serialize = (data) => {\n    const json = JSON.stringify(data);\n    const u8 = new Uint8Array(json.length);\n    for (let i = 0; i < json.length; i++) {\n        const code = json.charCodeAt(i);\n        if (code > 256) {\n            throw new RangeError(\"\");\n        }\n        u8[i] = code;\n    }\n    return u8;\n};\nconst deserialize = (u8) => {\n    let json = \"\";\n    for (const code of u8) {\n        json += String.fromCharCode(code);\n    }\n    return JSON.parse(json);\n};\nimport { AtomicsNotifyer } from \"./AtomicsNotifyer\";\nimport { u8Concat } from \"./helper\";\nimport { DataPkg } from \"./DataPkg\";\nimport { u32 } from \"./u32\";\nexport class Duplex {\n    constructor(_port, sabs) {\n        this._port = _port;\n        this._notifyer = new AtomicsNotifyer(this._port);\n        this._eventId = new Uint32Array(1);\n        this._chunkCollection = new Map();\n        this.supportModes = new Set();\n        this._cbs = [];\n        // Reflect.set(globalThis, \"duplex\", this);\n        this.supportModes.add(\"async\");\n        this.supportModes.add(\"sync\");\n        const localeDataPkg = new DataPkg(\"locale\", sabs.locale);\n        const remoteDataPkg = new DataPkg(\"remote\", sabs.remote);\n        this._sync = {\n            sabs,\n            localeDataPkg,\n            remoteDataPkg,\n        };\n        _port.onMessage((data) => {\n            if (data instanceof Array) {\n                this._checkRemote();\n            }\n        });\n    }\n    static getPort(duplex) {\n        return duplex._port;\n    }\n    /**发送异步消息 */\n    postAsyncMessage(msg) {\n        this._postMessageCallback((hook) => {\n            this._notifyer.waitCallback(hook.si32, 0 /* SI32_MSG_TYPE */, hook.curMsgType, hook.next);\n        }, (hook) => {\n            this._notifyer.waitCallback(hook.si32, 0 /* SI32_MSG_TYPE */, hook.msgType, hook.next);\n        }, msg);\n    }\n    postSyncMessage(msg) {\n        this._postMessageCallback((hook) => {\n            this._checkRemoteAtomics();\n            // console.debug(threadId, \"+openSAB\");\n            Atomics.wait(hook.si32, 0 /* SI32_MSG_TYPE */, hook.curMsgType);\n            // console.debug(threadId, \"-openSAB\");\n            hook.next();\n        }, (hook) => {\n            this._checkRemoteAtomics();\n            // console.debug(threadId, \"+waitSAB\");\n            // 进入等待\n            Atomics.wait(hook.si32, 0 /* SI32_MSG_TYPE */, hook.msgType);\n            // console.debug(threadId, \"-waitSAB\");\n            hook.next();\n        }, msg);\n    }\n    waitMessage() {\n        do {\n            // 等待对方开始响应\n            Atomics.wait(this._sync.remoteDataPkg.si32, 0 /* SI32_MSG_TYPE */, 0 /* FREE */);\n            // 处理响应的内容\n            const msg = this._checkRemoteAtomics();\n            if (msg) {\n                return msg;\n            }\n        } while (true);\n    }\n    _postMessageCallback(onApplyWrite, onChunkReady, msg) {\n        // console.debug(\"postMessage\", threadId, msg);\n        const msgBinary = this._serializeMsg(msg);\n        const sync = this._sync;\n        const { su8, si32, su16 } = sync.localeDataPkg;\n        // 数据id，用于将数据包和事件进行关联的ID\n        const eventId = this._eventId[0]++;\n        //#region 首先传输数据包\n        {\n            /// 自动分包模式\n            const MSG_MAX_BYTELENGTH = su8.byteLength - 20 /* U8_MSG_DATA_OFFSET */;\n            const chunkCount = Math.ceil(msgBinary.byteLength / MSG_MAX_BYTELENGTH);\n            let chunkId = 0;\n            let msgOffset = 0; // msgBinary.byteLength\n            /**尝试写入 */\n            const tryWriteChunk = () => {\n                if (chunkId >= chunkCount) {\n                    return;\n                }\n                // 申请写入权\n                checkAndApplyWrite();\n            };\n            /**申请写入权 */\n            const checkAndApplyWrite = () => {\n                // 直接申请\n                const cur_msg_type = Atomics.compareExchange(si32, 0 /* SI32_MSG_TYPE */, 0 /* FREE */, 1 /* EVENT */);\n                /// 申请成功\n                if (cur_msg_type === 0 /* FREE */) {\n                    // 开始写入状态\n                    Atomics.store(si32, 1 /* SI32_MSG_STATUS */, 0 /* WRITING */);\n                    doWriteChunk();\n                    return;\n                }\n                // 直接申请失败，转交给外部，让外部去申请\n                onApplyWrite({\n                    si32,\n                    msgType: 1 /* EVENT */,\n                    curMsgType: cur_msg_type,\n                    next: checkAndApplyWrite,\n                });\n            };\n            /**获取写入权后，写入数据 */\n            const doWriteChunk = () => {\n                // 写入消息ID\n                si32[2 /* U32_EVENT_ID_INDEX */] = eventId;\n                // 写入总包数\n                su16[5 /* U16_CHUNK_COUNT_INDEX */] = chunkCount;\n                // 写入包编号\n                su16[6 /* U16_CHUNK_ID_INDEX */] = chunkId;\n                // 取出可以用于发送的数据包\n                const msgChunk = msgBinary.subarray(msgOffset, \n                // 累加偏移量\n                Math.max(msgBinary.byteLength, (msgOffset += MSG_MAX_BYTELENGTH)));\n                // 写入数据包的大小\n                si32[4 /* U32_MSG_CHUNK_SIZE_INDEX */] = msgChunk.byteLength;\n                // 写入数据\n                su8.set(msgChunk, 20 /* U8_MSG_DATA_OFFSET */);\n                // 写入完成\n                Atomics.store(si32, 1 /* SI32_MSG_STATUS */, 1 /* FINISH */);\n                // 广播变更\n                this._notifyer.notify(si32, [0 /* SI32_MSG_TYPE */, 1 /* SI32_MSG_STATUS */]);\n                // 钩子参数\n                const hook = {\n                    msgType: 1 /* EVENT */,\n                    si32,\n                    chunkId,\n                    chunkCount,\n                    next: tryWriteChunk,\n                };\n                // 累加分包ID\n                chunkId++;\n                // 告知外部，写入完成了\n                onChunkReady(hook);\n            };\n            // 开始尝试写入\n            tryWriteChunk();\n        }\n        //#endregion\n    }\n    /**主动检测远端是否发来消息 */\n    _checkRemoteAtomics() {\n        const { remoteDataPkg } = this._sync;\n        /// 如果本地还未收到消息，而且远端的堆栈信息不为空，那么就可以开始处理\n        if (this._needOnMessageAtomics(remoteDataPkg)) {\n            return this._onMessage(remoteDataPkg);\n        }\n    }\n    _checkRemote() {\n        const { remoteDataPkg } = this._sync;\n        /// 如果本地还未收到消息，而且远端的堆栈信息不为空，那么就可以开始处理\n        if (this._needOnMessage(remoteDataPkg)) {\n            return this._onMessage(remoteDataPkg);\n        }\n    }\n    /**是否需要处理消息 */\n    _needOnMessageAtomics(dataPkg) {\n        if (dataPkg.si32[0 /* SI32_MSG_TYPE */] !== 0 /* FREE */) {\n            do {\n                const cur_msg_status = dataPkg.si32[1 /* SI32_MSG_STATUS */];\n                if (cur_msg_status === 1 /* FINISH */) {\n                    break;\n                }\n                // console.debug(threadId, \"+needOnMessage\");\n                Atomics.wait(dataPkg.si32, 1 /* SI32_MSG_STATUS */, cur_msg_status);\n                // console.debug(threadId, \"-needOnMessage\");\n            } while (true);\n            return true;\n        }\n        return false;\n    }\n    /**是否需要处理消息 */\n    _needOnMessage(dataPkg) {\n        return (dataPkg.si32[0 /* SI32_MSG_TYPE */] !== 0 /* FREE */ &&\n            dataPkg.si32[1 /* SI32_MSG_STATUS */] === 1 /* FINISH */);\n    }\n    /**处理消息指令 */\n    _onMessage(dataPkg) {\n        const { si32, su8, su16 } = dataPkg;\n        switch (si32[0 /* SI32_MSG_TYPE */]) {\n            case 1 /* EVENT */:\n                {\n                    /**事件ID */\n                    const eventId = si32[2 /* U32_EVENT_ID_INDEX */];\n                    /**分包的数量 */\n                    const chunkCount = su16[5 /* U16_CHUNK_COUNT_INDEX */];\n                    /**数据包编号*/\n                    const chunkId = su16[6 /* U16_CHUNK_ID_INDEX */];\n                    /**数据包大小 */\n                    const chunkSize = si32[4 /* U32_MSG_CHUNK_SIZE_INDEX */];\n                    /**数据包 */\n                    const chunk = su8.subarray(20 /* U8_MSG_DATA_OFFSET */, 20 /* U8_MSG_DATA_OFFSET */ + chunkSize);\n                    let cachedChunkInfo;\n                    let msgBinary;\n                    /// 单包\n                    if (1 === chunkCount) {\n                        msgBinary = new Uint8Array(chunk);\n                    }\n                    else {\n                        /// 分包\n                        cachedChunkInfo = this._chunkCollection.get(eventId);\n                        if (cachedChunkInfo) {\n                            cachedChunkInfo.set(chunkId, chunk);\n                            /// 如果数据包已经完整了，那么整理出完整的数据包\n                            if (cachedChunkInfo.size === chunkCount) {\n                                // 删除缓存\n                                this._chunkCollection.delete(eventId);\n                                /// 合并分包\n                                const chunkList = [];\n                                /**\n                                 * 这里支持无序传输，如果底层使用WebRTC，可以更节省设备资源\n                                 */\n                                for (const chunkItem of cachedChunkInfo) {\n                                    chunkList[chunkItem[0]] = chunkItem[1];\n                                }\n                                msgBinary = u8Concat(ArrayBuffer, chunkList);\n                            }\n                        }\n                        else {\n                            cachedChunkInfo = new Map();\n                            cachedChunkInfo.set(chunkId, new Uint8Array(chunk));\n                        }\n                    }\n                    // 释放调度\n                    // this._closeSAB(si32);\n                    Atomics.store(si32, 0 /* SI32_MSG_TYPE */, 0 /* FREE */);\n                    this._notifyer.notify(si32, [0 /* SI32_MSG_TYPE */]);\n                    /// 如果有完整的数据包，那么触发事件\n                    if (msgBinary) {\n                        // 触发事件\n                        return this._msgBinaryHandler(msgBinary);\n                    }\n                }\n                break;\n        }\n    }\n    _msgBinaryHandler(msgBinary) {\n        // console.debug(\"onMessage\", threadId, msgBinary);\n        let msg;\n        try {\n            switch (msgBinary[0]) {\n                case 1 /* REQ */:\n                    msg = {\n                        msgType: \"REQ\",\n                        msgId: u32\n                            .setByU8(msgBinary.subarray(1, 5 /* Uint32Array.BYTES_PER_ELEMENT+1 */))\n                            .getU32(),\n                        msgContent: deserialize(msgBinary.subarray(5)),\n                    };\n                    break;\n                case 2 /* RES */:\n                    msg = {\n                        msgType: \"RES\",\n                        msgId: u32\n                            .setByU8(msgBinary.subarray(1, 5 /* Uint32Array.BYTES_PER_ELEMENT+1 */))\n                            .getU32(),\n                        msgContent: deserialize(msgBinary.subarray(5)),\n                    };\n                    break;\n                case 0 /* SIM */:\n                    msg = {\n                        msgType: \"SIM\",\n                        msgId: undefined,\n                        msgContent: deserialize(msgBinary.subarray(1)),\n                    };\n                    break;\n                default:\n                    throw new TypeError(`unknown msgType:'${msgBinary[0]}'`);\n            }\n        }\n        catch (err) {\n            debugger;\n            throw err;\n        }\n        for (const cb of this._cbs) {\n            cb(msg);\n        }\n        return msg;\n    }\n    onMessage(cb) {\n        this._cbs.push(cb);\n    }\n    /// 消息序列化\n    // private _msg_ABC: typeof SharedArrayBuffer | typeof ArrayBuffer = ArrayBuffer;\n    _serializeMsg(msg) {\n        let msgBinary;\n        if (msg.msgType === \"SIM\") {\n            msgBinary = u8Concat(ArrayBuffer, [[0 /* SIM */], serialize(msg.msgContent)]);\n        }\n        else {\n            msgBinary = u8Concat(ArrayBuffer, [\n                [msg.msgType === \"REQ\" ? 1 /* REQ */ : 2 /* RES */],\n                new Uint8Array(new Uint32Array([msg.msgId]).buffer),\n                serialize(msg.msgContent),\n            ]);\n        }\n        return msgBinary;\n    }\n}\n","import { helper } from \"@bfchain/comlink-core\";\nexport class MagicBinaryPort {\n    constructor(_duplex) {\n        this._duplex = _duplex;\n        this._reqId = new Uint32Array(1);\n        this._resMap = new Map();\n        _duplex.onMessage((msg) => {\n            if (msg.msgType === \"RES\") {\n                const resId = msg.msgId;\n                const output = this._resMap.get(resId);\n                if (!output) {\n                    throw new TypeError(\"no found responser\");\n                    // return;\n                }\n                this._resMap.delete(resId);\n                const ret = msg.msgContent;\n                helper.SyncForCallback(output, () => {\n                    const resBin = helper.OpenArg(ret);\n                    if (!resBin) {\n                        throw new TypeError();\n                    }\n                    return resBin;\n                });\n            }\n            else {\n                const reqId = msg.msgId;\n                this._reqHandler((ret) => {\n                    if (reqId === undefined) {\n                        return;\n                    }\n                    this._postModeMessage({\n                        msgType: \"RES\",\n                        msgId: reqId,\n                        msgContent: ret,\n                    });\n                }, msg.msgContent);\n            }\n        });\n    }\n    onMessage(listener) {\n        this._reqHandler = listener;\n    }\n    send(bin) {\n        this._duplex.postAsyncMessage({\n            msgType: \"SIM\",\n            msgId: undefined,\n            msgContent: bin,\n        });\n    }\n}\nexport class SyncBinaryPort extends MagicBinaryPort {\n    _postModeMessage(msg) {\n        this._duplex.postSyncMessage(msg);\n    }\n    req(output, bin) {\n        const reqId = this._reqId[0]++;\n        let hasOutput = false;\n        const reqOutput = (ret) => {\n            hasOutput = true;\n            output(ret);\n        };\n        // 先存放回调\n        this._resMap.set(reqId, reqOutput);\n        // 发送，同步模式会直接触发回调\n        this._postModeMessage({\n            msgType: \"REQ\",\n            msgId: reqId,\n            msgContent: bin,\n        });\n        /// 同步模式：发送完成后，马上就需要对方有响应才意味着 postMessage 完成\n        while (hasOutput === false) {\n            this._duplex.waitMessage();\n        }\n    }\n}\nexport class AsyncBinaryPort extends MagicBinaryPort {\n    _postModeMessage(msg) {\n        this._duplex.postAsyncMessage(msg);\n    }\n    req(output, bin) {\n        const reqId = this._reqId[0]++;\n        this._resMap.set(reqId, output);\n        this._postModeMessage({\n            msgType: \"REQ\",\n            msgId: reqId,\n            msgContent: bin,\n        });\n    }\n}\n","import { AsyncBinaryPort, SyncBinaryPort } from \"./MagicBinaryPort\";\nclass MagicBinaryChannel {\n    constructor(_duplex, localSab = new SharedArrayBuffer(1024), remoteSab = new SharedArrayBuffer(1024)) {\n        this._duplex = _duplex;\n        this.localSab = localSab;\n        this.remoteSab = remoteSab;\n    }\n}\nexport class SyncBinaryChannel extends MagicBinaryChannel {\n    constructor() {\n        super(...arguments);\n        this.port = new SyncBinaryPort(this._duplex);\n    }\n}\nexport class AsyncBinaryChannel extends MagicBinaryChannel {\n    constructor() {\n        super(...arguments);\n        this.port = new AsyncBinaryPort(this._duplex);\n    }\n}\n","import \"./@types\";\nexport * from \"@bfchain/comlink-core\";\nexport * from \"@bfchain/comlink-protocol\";\nexport * from \"@bfchain/comlink-sync\";\nexport * from \"@bfchain/comlink-async\";\nexport * from \"@bfchain/comlink-duplex-core\";\nimport { AsyncBinaryChannel, SyncBinaryChannel } from \"@bfchain/comlink-channel\";\nimport { ComlinkAsync } from \"@bfchain/comlink-async\";\nimport { ComlinkSync } from \"@bfchain/comlink-sync\";\nexport class Comlink {\n    constructor(options) { }\n    asyncModule(moduleName, duplex) {\n        if (!duplex.supportModes.has(\"async\")) {\n            throw new TypeError(\"duplex no support async mode\");\n        }\n        const binaryChannel = new AsyncBinaryChannel(duplex);\n        return new ComlinkAsync(binaryChannel.port, moduleName);\n    }\n    syncModule(moduleName, duplex) {\n        if (!duplex.supportModes.has(\"sync\")) {\n            throw new TypeError(\"duplex no support sync mode\");\n        }\n        const binaryChannel = new SyncBinaryChannel(duplex);\n        return new ComlinkSync(binaryChannel.port, moduleName);\n    }\n}\n","export class Endpoint {\n    constructor(_port) {\n        this._port = _port;\n        this.postMessage = this._port.postMessage.bind(this._port);\n    }\n    onMessage(listener) {\n        this._port.start();\n        this._port.addEventListener(\"message\", (e) => listener(e.data));\n    }\n}\n// export const EndpointFactory: BFChainComlink.Duplex.EndpointFactory = (port: MessagePort) => {\n//   return new Endpoint(port);\n// };\n","import { Duplex } from \"@bfchain/comlink-duplex-core\";\nimport { Endpoint } from \"./Endpoint\";\nconst PORT_SABS_WM = new WeakMap();\nexport class DuplexFactory {\n    constructor(_mc = new MessageChannel()) {\n        this._mc = _mc;\n    }\n    /**作为子线程运作 */\n    static async asCluster(workerSelf) {\n        let sabs;\n        const port2 = await new Promise((resolve, reject) => {\n            const onMessage = (me) => {\n                const { data } = me;\n                if (data instanceof MessagePort) {\n                    resolve(data);\n                    workerSelf.removeEventListener(\"message\", onMessage);\n                }\n                else if (data instanceof Array &&\n                    data[0] instanceof SharedArrayBuffer &&\n                    data[1] instanceof SharedArrayBuffer) {\n                    sabs = { locale: data[0], remote: data[1] };\n                }\n            };\n            workerSelf.addEventListener(\"message\", onMessage);\n        });\n        if (!sabs) {\n            throw new TypeError();\n        }\n        PORT_SABS_WM.set(port2, sabs);\n        const duplex = new Duplex(new Endpoint(port2), sabs);\n        return duplex;\n    }\n    _getSabs(port) {\n        let sabs = PORT_SABS_WM.get(port);\n        if (undefined === sabs) {\n            try {\n                sabs = {\n                    locale: new SharedArrayBuffer(1024),\n                    remote: new SharedArrayBuffer(1024),\n                };\n                PORT_SABS_WM.set(port, sabs);\n            }\n            catch (err) {\n                console.error(err);\n                throw new SyntaxError(\"no support use SharedArrayBuffer\");\n            }\n        }\n        return sabs;\n    }\n    /**创建出专门用于传输协议数据的双工通道 */\n    getDuplex() {\n        let duplex = this._duplex;\n        if (!duplex) {\n            const sabs = this._getSabs(this._mc.port1);\n            duplex = new Duplex(new Endpoint(this._mc.port1), sabs);\n            this._duplex = duplex;\n        }\n        return duplex;\n    }\n    /**作为主线程运作 */\n    asMain(workerIns) {\n        const sabs = this._getSabs(this._mc.port1);\n        try {\n            workerIns.postMessage([sabs.remote, sabs.locale]);\n        }\n        catch (err) {\n            console.error(err);\n            throw new SyntaxError(\"no support use transfer SharedArrayBuffer in channel\");\n        }\n        workerIns.postMessage(this._mc.port2, [this._mc.port2]);\n    }\n}\n","export class TaskLog {\n    constructor(groupName) {\n        this.groupName = groupName;\n        this._fails = [];\n        this.log = console.log;\n        this.warn = console.warn;\n        this.error = console.error;\n        this.info = console.info;\n        this.debug = console.debug;\n    }\n    assert(isTrue, msg) {\n        if (!isTrue) {\n            this._fails.push(msg);\n        }\n        console.assert(isTrue, msg);\n    }\n    finish() {\n        if (this._fails.length === 0) {\n            console.log(`✅ ~ all [${this.groupName}] test passed!`);\n        }\n        else {\n            console.error(`⛔ [${this.groupName}] has ${this._fails.length} test failed.`);\n        }\n    }\n}\n","import { Comlink } from \"@bfchain/comlink\";\nimport { DuplexFactory } from \"@bfchain/comlink-duplex-browser\";\n// import {} from \"../innerComlink/index\";\nimport { TaskLog } from \"./TaskLog\";\nconst comlink = new Comlink();\nexport async function installWebEnv(scriptUrl, mainThreadCallback, workerThreadCallback, workerThreadCallback2) {\n    var _a, _b;\n    if (scriptUrl) {\n        console.log(\"main started\");\n        /// 模拟A模块作为服务模块\n        try {\n            {\n                const duplexFactory = new DuplexFactory();\n                /**模块控制器 */\n                const moduleA = comlink.asyncModule(\"A\", duplexFactory.getDuplex());\n                // 执行回调\n                await mainThreadCallback(moduleA);\n                {\n                    /// 启动子线程，并将messagechannel发送给子线程\n                    const worker = new Worker(scriptUrl, {\n                        name: \"async\",\n                    });\n                    worker.onmessage = (e) => e.data === \"exit\" && worker.terminate();\n                    // 执行发送\n                    duplexFactory.asMain(worker);\n                }\n            }\n            {\n                const duplexFactory2 = new DuplexFactory();\n                const moduleA2 = comlink.asyncModule(\"A\", duplexFactory2.getDuplex());\n                // 执行回调\n                await mainThreadCallback(moduleA2);\n                {\n                    /// 启动子线程，并将messagechannel发送给子线程\n                    const worker = new Worker(scriptUrl, {\n                        name: \"sync\",\n                    });\n                    worker.onmessage = (e) => e.data === \"exit\" && worker.terminate();\n                    // 执行发送\n                    duplexFactory2.asMain(worker);\n                }\n            }\n        }\n        catch (err) {\n            console.error(\"❌ Main Error\", (_a = err === null || err === void 0 ? void 0 : err.stack) !== null && _a !== void 0 ? _a : err);\n            return;\n        }\n    }\n    else {\n        const mode = self.name;\n        const console = new TaskLog(`mix-${mode}`);\n        console.log(`worker ${mode} started`);\n        try {\n            /// 等待通道连接到位\n            const duplex = await DuplexFactory.asCluster(self);\n            if (mode === \"async\") {\n                /// 模拟B模块作为调用模块\n                /**模块控制器 */\n                const moduleB = comlink.asyncModule(\"B\", duplex);\n                // 回调\n                await workerThreadCallback(moduleB, console);\n            }\n            else {\n                /**模块控制器 */\n                const moduleB2 = comlink.syncModule(\"B2\", duplex);\n                // 回调\n                await workerThreadCallback2(moduleB2, console);\n            }\n            console.finish();\n        }\n        catch (err) {\n            console.error(\"❌ Worker Error\", (_b = err === null || err === void 0 ? void 0 : err.stack) !== null && _b !== void 0 ? _b : err);\n        }\n        // 退出子线程\n        setTimeout(() => {\n            self.postMessage(\"exit\");\n        }, 10);\n    }\n}\n","import { HolderReflect } from \"@bfchain/comlink\";\nimport { installWebEnv } from \"./envWrapper/webEnv\";\nfunction testRunner(scriptUrl) {\n    const A = \"~aAa~\";\n    installWebEnv(scriptUrl, (moduleA) => {\n        /**随便一个常量 */\n        const a = A;\n        moduleA.export(a, \"a\");\n        moduleA.export(document, \"document\");\n    }, async (moduleB, console) => {\n        const a = await moduleB.import(\"a\");\n        Reflect.set(globalThis, \"a\", a);\n        console.assert(a === A, \"import\");\n        const document = await moduleB.import(\"document\");\n        Reflect.set(globalThis, \"document\", document);\n        const div = await document.createElement(\"div\");\n        const id = `id-${self.name}-${Math.random().toString(36).slice(2)}`;\n        const textContent = `T~${self.name}~#${id}~T`;\n        div.id = id;\n        div.textContent = textContent;\n        document.body.appendChild(div);\n        console.log(await div.textContent);\n        console.assert((await div.textContent) === textContent, \"textContent\");\n        const div2 = await document.querySelector(\"#\" + id);\n        console.assert(JSON.stringify(HolderReflect.getHolderReflect(div).getIOB()) ===\n            JSON.stringify(HolderReflect.getHolderReflect(div2).getIOB()), \"ref\");\n    }, (moduleB, console) => {\n        /// test import\n        const a = moduleB.import(\"a\");\n        Reflect.set(self, \"a\", a);\n        console.assert(a === A, \"import\");\n        const document = moduleB.import(\"document\");\n        Reflect.set(self, \"document\", document);\n        const div = document.createElement(\"div\");\n        const id = `id-${self.name}-${Math.random().toString(36).slice(2)}`;\n        const textContent = `T~${self.name}~#${id}~T`;\n        div.id = id;\n        div.textContent = textContent;\n        document.body.appendChild(div);\n        console.assert(div.textContent === textContent, \"textContent\");\n        const div2 = document.querySelector(\"#\" + id);\n        console.assert(div2 === div, \"ref\");\n    });\n}\nReflect.set(self, \"testRunner\", testRunner);\nif (typeof document !== \"object\") {\n    testRunner();\n}\nelse {\n    testRunner(document.querySelector(\"script\").src);\n}\n"],"names":["isObj","obj","targetType","checkUnregisterToken","unregisterToken","TypeError","checkTarget","target","WeakRef","wr","WeakMap","constructor","set","deref","get","Object","defineProperty","globalThis","value","FinalizationRegistry","FinalizationGroup","cleanupCallback","fg","heldValueIter","heldValue","register","unregister","undefined","ESM_REFLECT_FUN_MAP","Map","_SyncToCallback","Reflect","getPrototypeOf","proto","setPrototypeOf","isExtensible","preventExtensions","prop","getOwnPropertyDescriptor","has","deleteProperty","attr","ownKeys","ctx","args","apply","type","fun","resolve","reject","queueMicrotask","res","err","newTarget","construct","ctor","JSON","stringify","parse","handler","SyncForCallback","cb","isError","data","error","resolveCallback","rejectCallback","SyncPiperFactory","output","transformer","OpenArg","arg","ExportStore","name","accId","objIdStore","getObjById","id","cache","getSymById","sym","getId","saveObjId","saveSymId","releaseById","delete","exportSymbol","source","_a","exportObject","ImportStore","idExtendsStore","proxyIdStore","proxyIdWM","_fr","releaseProxyId","getProxy","proxy","isProxy","getProxyById","pwr","saveProxyId","backupProxyId","_onReleaseCallback","onRelease","ComlinkCore","port","exportStore","importStore","_exportModule","scope","create","isExported","_listen","$destroy","Error","_getInitedExportScope","export","$getEsmReflectHanlder","operator","SyntaxError","onMessage","bin","out_void","linkObj","transfer","transferableBinary2LinkObj","targetId","ReferenceError","linkOut","out","isThrow","out_linkOut","anyRes","Any2InOutBinary","iobRet","push","linkObj2TransferableBinary","InOutBinary2Any","in","paramList","slice","map","iob","i","length","len","$operator","$paramList","$handler","hasOut","scopeRet","module","locId","refId","send","$getImportModule","_importModule","req","ret","IOB_EFT_Factory_Map","factory","Function","toString","refExtends","funType","factoryCode","getFunctionType","ctorName","str","call","startsWith","EXPORT_FUN_DESCRIPTOR_SYMBOL","Symbol","getFunctionExportDescription","IMPORT_FUN_EXTENDS_SYMBOL","refFunctionStaticToStringFactory","self","mode","code","configurable","writable","getObjectStatus","isFrozen","isSealed","globalSymbolStore","forEach","ModelTransfer","core","canClone","_getRemoteSymbolItemExtends","_b","globalSymInfo","global","description","unique","keyFor","_getRefItemExtends","status","exportDescriptor","isStatic","instanceOfFunction","canConstruct","prototype","showSourceCode","helper","needClone","item","imp","extends","CB_TO_SYNC_ERROR","CallbackToSync","cbCaller","_ret","IS_ASYNC_APPLY_FUN_MARKER","IS_SYNC_APPLY_FUN_MARKER","PROTOCAL_SENDER","SENDER_MARKER","SyncModelTransfer","_rfsts","_genLinkInSender","linkIn","_reqLinkIn","_sendLinkIn","__marker__","_getDefaultProxyHanlder","sender","proxyHandler","_target","_reciver","_receiver","thisArg","argArray","_pkgLinkIn","a","tb","err_iob","pop","res_iob","_createImportByRefId","refHook","_createImportRefHook","getSource","proxyHanlder","getProxyHanlder","Proxy","getLinkInSenderByProxy","ref","sourceFun","funRef","defaultProxyHanlder","functionProxyHanlder","receiver","sourceObj","objRef","sourceSym","for","symRef","loc","cachedProxy","ComlinkSync","_syncWM","_asyncWM","opeartor","hanlder","applyHanlder","import","key","importModule","importAsSync","asyncToSync","syncFun","r","importAsAsync","syncToAsync","asyncFun","Promise","bindThis","propertyKey","descriptor","bound","bind","CACHE_KEYS_SYMBOL","getCacheKeys","protoTarget","CACHE_KEYS","keyGenerator","symbol","String","cacheGetter","propTarget","source_fun","CACHE_VALUE_SYMBOL","getter","cacheValue","enumerable","console","cleanGetterCache","_cleanGetterCache","cleanAllGetterCache","__decorate","this","decorators","desc","c","arguments","d","decorate","__metadata","k","v","metadata","PropArrayHelper","pid","Math","random","substr","CLASS_PROTO_ARRAYDATA_POOL","PA_ID_KEY","PA_ID_VALUE","Set","CLASS_PROTO_ARRAYDATA","hasOwnProperty","arr_data","add","pa_id","remove","index","indexOf","splice","THROTTLE_WRAP_PLOT","NO_ALLOW_PROP","toPrimitive","toStringTag","hasInstance","species","iterator","isConcatSpreadable","match","matchAll","replace","search","split","__THEN_DISABLED__","WeakSet","createHolderProxyHanlder","holderReflect","toValueSync","isHolder","thenFun","assetHolder","Operator_typeOfHolder","typeNameRet","applyHolder","toHolder","then","asyncIterator","toAsyncValue","setHolderReflect","setHolder","deletePropertyHolder","applyHolderReflect","constructHolderReflect","constructHolder","__HOLDER_REFLECT_WM__","__REFLECT_HOLDER_WM__","getHolder","holder","getHolderReflect","CallbackToAsync","syncRet","syncResolve","syncReject","CallbackToAsyncBind","isNil","ReflectForbidenMethods","_factory_NoObject","_factory","nilGet","method","errorMessage","ID_ACC","reflectForbidenMethods","refFunctionStaticToString","alwaysTrueCallbackCaller","alwaysFalseCallbackCaller","alwaysUndefinedCallbackCaller","end","iobCacher","HolderReflect","linkSenderArgs","staticMode","_iobCacher","needSend","waitter","sendLinkIn","_getCatchedReflect","toValue","_catchedReflect","_catched","bindIOB","cacher","remoteIob","newIobCacher","getIOB","isBindedIOB","waitIOB","createSubHolder","subHolderLinkIn","_getSubHolderPrimitiveSync","throw_binded","apply_local","thisArgument","argumentsList","apply_remote","applyCallback","construct_local","construct_remote","constructCallback","defineProperty_local","attributes","definePropertyHolder","defineProperty_remote","definePropertyCallback","deleteProperty_localObject","deleteProperty_remote","deletePropertyCallback","get_remoteFunction","iobExtends","get_remote","get_local","getCallback","getOwnPropertyDescriptor_remoteFunction","getOwnPropertyDescriptor_remote","getOwnPropertyDescriptor_local","getOwnPropertyDescriptorHolder","getOwnPropertyDescriptorCallback","getPrototypeOf_local","getPrototypeOfHolder","getPrototypeOf_remote","getPrototypeOfCallback","has_remoteFunction","has_remote","has_local","hasHolder","hasCallback","isExtensible_local","isExtensibleHolder","isExtensible_remote","isExtensibleCallback","ownKeys_local","ownKeysHolder","ownKeys_remote","ownKeysCallback","preventExtensions_local","preventExtensionsHolder","preventExtensions_remote","preventExtensions_onceRemote","preventExtensionsCallback","set_local","set_remote","setCallback","setPrototypeOf_local","setPrototypeOfHolder","setPrototypeOf_remote","setPrototypeOfCallback","asset_value","asset_remote","assetCallback","asset","hint","Operator_instanceOf","Ctor","Operator_instanceOfHolder","Operator_typeOf","Operator_delete","Operator_spread","Operator_in","iterable","next","done","Array_concat","String_match","String_matchAll","String_replace","String_search","String_split","Object_assign","Object_create","Object_defineProperties","Object_defineProperty","Object_entries","Object_freeze","Object_fromEntries","Object_getOwnPropertyDescriptor","Object_getOwnPropertyDescriptors","Object_getOwnPropertyNames","Object_getOwnPropertySymbols","Object_getPrototypeOf","Object_is","Object_isExtensible","Object_isFrozen","Object_isSealed","Object_keys","Object_preventExtensions","Object_seal","Object_setPrototypeOf","Object_values","JSON_stringify","JSON_parse","AsyncModelTransfer","doReq","linkInIob","linkInIOB","linkInIOBLength","isRejected","_createHolderByRefId","_getHolder","reflectHolder","valRet","cachedHolder","ComlinkAsync","wrap","val","AtomicsNotifyer","_port","_icbs","_remoteMode","Array","cbs","waitAsync","si32","waitCallback","Atomics","load","remoteMode","notify","_notify_async","_notify_sync","_notify_unknow","indexs","postMessage","u8Concat","ABC","u8s","totalLen","u8","u8a","Uint8Array","offsetLen","DataPkg","sab","Int32Array","su8","su16","Uint16Array","U32Reader","_u32","Uint32Array","_u8","buffer","setByU8","getU32","u32","serialize","json","charCodeAt","RangeError","deserialize","fromCharCode","Duplex","sabs","_notifyer","_eventId","_chunkCollection","supportModes","_cbs","localeDataPkg","locale","remoteDataPkg","remote","_sync","_checkRemote","getPort","duplex","postAsyncMessage","msg","_postMessageCallback","hook","curMsgType","msgType","postSyncMessage","_checkRemoteAtomics","wait","waitMessage","onApplyWrite","onChunkReady","msgBinary","_serializeMsg","sync","eventId","MSG_MAX_BYTELENGTH","byteLength","chunkCount","ceil","chunkId","msgOffset","tryWriteChunk","checkAndApplyWrite","cur_msg_type","compareExchange","store","doWriteChunk","msgChunk","subarray","max","_needOnMessageAtomics","_onMessage","_needOnMessage","dataPkg","cur_msg_status","chunkSize","chunk","cachedChunkInfo","size","chunkList","chunkItem","ArrayBuffer","_msgBinaryHandler","msgId","msgContent","MagicBinaryPort","_duplex","_reqId","_resMap","resId","resBin","reqId","_reqHandler","_postModeMessage","listener","SyncBinaryPort","hasOutput","reqOutput","AsyncBinaryPort","MagicBinaryChannel","localSab","SharedArrayBuffer","remoteSab","SyncBinaryChannel","AsyncBinaryChannel","Comlink","options","asyncModule","moduleName","binaryChannel","syncModule","Endpoint","start","addEventListener","e","PORT_SABS_WM","DuplexFactory","_mc","MessageChannel","asCluster","workerSelf","port2","me","MessagePort","removeEventListener","_getSabs","getDuplex","port1","asMain","workerIns","TaskLog","groupName","_fails","log","warn","info","debug","assert","isTrue","finish","comlink","installWebEnv","scriptUrl","mainThreadCallback","workerThreadCallback","workerThreadCallback2","duplexFactory","moduleA","worker","Worker","onmessage","terminate","duplexFactory2","moduleA2","stack","moduleB","moduleB2","setTimeout","testRunner","A","document","div","createElement","textContent","body","appendChild","div2","querySelector","src"],"mappings":"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"}